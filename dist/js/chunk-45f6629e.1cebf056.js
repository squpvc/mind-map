(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-45f6629e"],{"00e8":function(e,t,i){"use strict";var n=i("d17d"),s=i("6ac9");class o{constructor(e){this.opt=e,this.mindMap=e.mindMap,this.addShortcut()}addShortcut(){this.onLeftKeyUp=this.onLeftKeyUp.bind(this),this.onUpKeyUp=this.onUpKeyUp.bind(this),this.onRightKeyUp=this.onRightKeyUp.bind(this),this.onDownKeyUp=this.onDownKeyUp.bind(this),this.mindMap.keyCommand.addShortcut(s["a"].KEY_DIR.LEFT,this.onLeftKeyUp),this.mindMap.keyCommand.addShortcut(s["a"].KEY_DIR.UP,this.onUpKeyUp),this.mindMap.keyCommand.addShortcut(s["a"].KEY_DIR.RIGHT,this.onRightKeyUp),this.mindMap.keyCommand.addShortcut(s["a"].KEY_DIR.DOWN,this.onDownKeyUp)}removeShortcut(){this.mindMap.keyCommand.removeShortcut(s["a"].KEY_DIR.LEFT,this.onLeftKeyUp),this.mindMap.keyCommand.removeShortcut(s["a"].KEY_DIR.UP,this.onUpKeyUp),this.mindMap.keyCommand.removeShortcut(s["a"].KEY_DIR.RIGHT,this.onRightKeyUp),this.mindMap.keyCommand.removeShortcut(s["a"].KEY_DIR.DOWN,this.onDownKeyUp)}onLeftKeyUp(){this.onKeyup(s["a"].KEY_DIR.LEFT)}onUpKeyUp(){this.onKeyup(s["a"].KEY_DIR.UP)}onRightKeyUp(){this.onKeyup(s["a"].KEY_DIR.RIGHT)}onDownKeyUp(){this.onKeyup(s["a"].KEY_DIR.DOWN)}onKeyup(e){if(this.mindMap.renderer.activeNodeList.length>0)this.focus(e);else{let e=this.mindMap.renderer.root;this.mindMap.execCommand("GO_TARGET_NODE",e)}}focus(e){let t=this.mindMap.renderer.activeNodeList[0],i=this.getNodeRect(t),n=null,s=1/0,o=(e,t)=>{let o=this.getDistance(i,e);o<s&&(n=t,s=o)};this.getFocusNodeByShadowAlgorithm({currentActiveNode:t,currentActiveNodeRect:i,dir:e,checkNodeDis:o}),n||this.getFocusNodeByAreaAlgorithm({currentActiveNode:t,currentActiveNodeRect:i,dir:e,checkNodeDis:o}),n||this.getFocusNodeBySimpleAlgorithm({currentActiveNode:t,currentActiveNodeRect:i,dir:e,checkNodeDis:o}),n&&this.mindMap.execCommand("GO_TARGET_NODE",n)}getFocusNodeBySimpleAlgorithm({currentActiveNode:e,currentActiveNodeRect:t,dir:i,checkNodeDis:o}){Object(n["d"])(this.mindMap.renderer.root,n=>{if(n.uid===e.uid)return;let a=this.getNodeRect(n),{left:r,top:h,right:d,bottom:l}=a,c=!1;i===s["a"].KEY_DIR.LEFT?c=d<=t.left:i===s["a"].KEY_DIR.RIGHT?c=r>=t.right:i===s["a"].KEY_DIR.UP?c=l<=t.top:i===s["a"].KEY_DIR.DOWN&&(c=h>=t.bottom),c&&o(a,n)})}getFocusNodeByShadowAlgorithm({currentActiveNode:e,currentActiveNodeRect:t,dir:i,checkNodeDis:o}){Object(n["d"])(this.mindMap.renderer.root,n=>{if(n.uid===e.uid)return;let a=this.getNodeRect(n),{left:r,top:h,right:d,bottom:l}=a,c=!1;i===s["a"].KEY_DIR.LEFT?c=r<t.left&&h<t.bottom&&l>t.top:i===s["a"].KEY_DIR.RIGHT?c=d>t.right&&h<t.bottom&&l>t.top:i===s["a"].KEY_DIR.UP?c=h<t.top&&r<t.right&&d>t.left:i===s["a"].KEY_DIR.DOWN&&(c=l>t.bottom&&r<t.right&&d>t.left),c&&o(a,n)})}getFocusNodeByAreaAlgorithm({currentActiveNode:e,currentActiveNodeRect:t,dir:i,checkNodeDis:o}){let a=(t.right+t.left)/2,r=(t.bottom+t.top)/2;Object(n["d"])(this.mindMap.renderer.root,t=>{if(t.uid===e.uid)return;let n=this.getNodeRect(t),{left:h,top:d,right:l,bottom:c}=n,m=(l+h)/2,u=(c+d)/2,f=m-a,p=u-r;if(0===f&&0===p)return;let x=!1;i===s["a"].KEY_DIR.LEFT?x=f<=0&&f<=p&&f<=-p:i===s["a"].KEY_DIR.RIGHT?x=f>0&&f>=-p&&f>=p:i===s["a"].KEY_DIR.UP?x=p<=0&&p<f&&p<-f:i===s["a"].KEY_DIR.DOWN&&(x=p>0&&-p<f&&p>f),x&&o(n,t)})}getNodeRect(e){let{scaleX:t,scaleY:i,translateX:n,translateY:s}=this.mindMap.draw.transform(),{left:o,top:a,width:r,height:h}=e;return{right:(o+r)*t+n,bottom:(a+h)*i+s,left:o*t+n,top:a*i+s}}getDistance(e,t){let i=this.getCenter(e),n=this.getCenter(t);return Math.sqrt(Math.pow(i.x-n.x,2)+Math.pow(i.y-n.y,2))}getCenter({left:e,right:t,top:i,bottom:n}){return{x:(e+t)/2,y:(i+n)/2}}beforePluginRemove(){this.removeShortcut()}beforePluginDestroy(){this.removeShortcut()}}o.instanceName="keyboardNavigation",t["a"]=o},"083c":function(e,t,i){"use strict";var n=i("0bd5");function s(e,t){let{associativeLineActiveColor:i}=this.getStyleConfig(e,t);this.controlLine1=this.associativeLineDraw.line().stroke({color:i,width:2}),this.controlLine2=this.associativeLineDraw.line().stroke({color:i,width:2}),this.controlPoint1=this.createOneControlNode("controlPoint1",e,t),this.controlPoint2=this.createOneControlNode("controlPoint2",e,t)}function o(e,t,i){let{associativeLineActiveColor:n}=this.getStyleConfig(t,i);return this.associativeLineDraw.circle(this.controlPointDiameter).stroke({color:n}).fill({color:"#fff"}).click(e=>{e.stopPropagation()}).mousedown(t=>{this.onControlPointMousedown(t,e)})}function a(e,t){e.stopPropagation(),e.preventDefault(),this.isControlPointMousedown=!0,this.mousedownControlPointKey=t}function r(e){if(!this.isControlPointMousedown||!this.mousedownControlPointKey||!this[this.mousedownControlPointKey])return;e.stopPropagation(),e.preventDefault();let t=this.controlPointDiameter/2,{x:i,y:s}=this.getTransformedEventPos(e);this.controlPointMousemoveState.pos={x:i,y:s},this[this.mousedownControlPointKey].x(i-t).y(s-t);let[,,,o,a]=this.activeLine,r=Object(n["d"])(o,a),{associativeLinePoint:h,associativeLineTargetControlOffsets:d}=o.getData();h=h||[];const l=this.getNodePos(o),c=this.getNodePos(a);let[m,u]=this.updateAllLinesPos(o,a,h[r]);this.controlPointMousemoveState.startPoint=m,this.controlPointMousemoveState.endPoint=u,this.controlPointMousemoveState.targetIndex=r;let f=[];f=d?d[r]:Object(n["e"])(m,u);let p=null,x=null;const{x:g,y:z}=this.mindMap.toPos(e.clientX,e.clientY),y={clientX:g,clientY:z};"controlPoint1"===this.mousedownControlPointKey?(m=Object(n["g"])(l,"",0,y),p={x:i,y:s},x={x:u.x+f[1].x,y:u.y+f[1].y},m&&(this.controlPointMousemoveState.startPoint=m,this.controlLine1.plot(m.x,m.y,p.x,p.y))):(u=Object(n["g"])(c,"",0,y),p={x:m.x+f[0].x,y:m.y+f[0].y},x={x:i,y:s},u&&(this.controlPointMousemoveState.endPoint=u,this.controlLine2.plot(u.x,u.y,x.x,x.y))),this.updataAassociativeLine(m,u,p,x,this.activeLine)}function h(e,t,i,s,o){const[a,r,h]=o,d=Object(n["h"])(e,t,i,s);a.plot(d),r.plot(d),this.updateTextPos(a,h),this.updateTextEditBoxPos(h)}function d(e){if(!this.isControlPointMousedown)return;e.stopPropagation(),e.preventDefault();let{pos:t,startPoint:i,endPoint:s,targetIndex:o}=this.controlPointMousemoveState,[,,,a]=this.activeLine,r=[],{associativeLinePoint:h,associativeLineTargetControlOffsets:d}=a.getData();h||(h=[]),h[o]=h[o]||{startPoint:i,endPoint:s},d?r=d:r[o]=Object(n["e"])(i,s);let l=null,c=null;"controlPoint1"===this.mousedownControlPointKey?(l={x:t.x-i.x,y:t.y-i.y},c=r[o][1],h[o].startPoint=i):(l=r[o][0],c={x:t.x-s.x,y:t.y-s.y},h[o].endPoint=s),r[o]=[l,c],this.mindMap.execCommand("SET_NODE_DATA",a,{associativeLineTargetControlOffsets:r,associativeLinePoint:h}),this.isNotRenderAllLines=!0,setTimeout(()=>{this.resetControlPoint()},0)}function l(){this.isControlPointMousedown=!1,this.mousedownControlPointKey="",this.controlPointMousemoveState={pos:null,startPoint:null,endPoint:null,targetIndex:""}}function c(e,t,i,n,s,o){if(!this.mindMap.opt.enableAdjustAssociativeLinePoints)return;this.controlLine1||this.createControlNodes(s,o);let a=this.controlPointDiameter/2;this.controlLine1.plot(e.x,e.y,i.x,i.y),this.controlLine2.plot(t.x,t.y,n.x,n.y),this.controlPoint1.x(i.x-a).y(i.y-a),this.controlPoint2.x(n.x-a).y(n.y-a)}function m(){this.controlLine1&&([this.controlLine1,this.controlLine2,this.controlPoint1,this.controlPoint2].forEach(e=>{e.remove()}),this.controlLine1=null,this.controlLine2=null,this.controlPoint1=null,this.controlPoint2=null)}function u(){this.controlLine1&&[this.controlLine1,this.controlLine2,this.controlPoint1,this.controlPoint2].forEach(e=>{e.hide()})}function f(){this.controlLine1&&[this.controlLine1,this.controlLine2,this.controlPoint1,this.controlPoint2].forEach(e=>{e.show()})}t["a"]={createControlNodes:s,createOneControlNode:o,onControlPointMousedown:a,onControlPointMousemove:r,onControlPointMouseup:d,resetControlPoint:l,renderControls:c,removeControls:m,hideControls:u,showControls:f,updataAassociativeLine:h}},"0ad9":function(e,t,i){"use strict";var n=i("d17d");class s{constructor({mindMap:e}){this.mindMap=e,this.touchesNum=0,this.singleTouchstartEvent=null,this.clickNum=0,this.touchStartScaleView=null,this.lastTouchStartPosition=null,this.lastTouchStartDistance=0,this.bindEvent()}bindEvent(){this.onTouchstart=this.onTouchstart.bind(this),this.onTouchmove=this.onTouchmove.bind(this),this.onTouchcancel=this.onTouchcancel.bind(this),this.onTouchend=this.onTouchend.bind(this),window.addEventListener("touchstart",this.onTouchstart,{passive:!1}),window.addEventListener("touchmove",this.onTouchmove,{passive:!1}),window.addEventListener("touchcancel",this.onTouchcancel,{passive:!1}),window.addEventListener("touchend",this.onTouchend,{passive:!1})}unBindEvent(){window.removeEventListener("touchstart",this.onTouchstart),window.removeEventListener("touchmove",this.onTouchmove),window.removeEventListener("touchcancel",this.onTouchcancel),window.removeEventListener("touchend",this.onTouchend)}onTouchstart(e){if(this.touchesNum=e.touches.length,this.touchStartScaleView=null,1===this.touchesNum){let t=e.touches[0];this.lastTouchStartPosition&&(this.lastTouchStartDistance=Object(n["Q"])(this.lastTouchStartPosition.x,this.lastTouchStartPosition.y,t.clientX,t.clientY)),this.lastTouchStartPosition={x:t.clientX,y:t.clientY},this.singleTouchstartEvent=t,this.dispatchMouseEvent("mousedown",t.target,t)}}onTouchmove(e){let t=e.touches.length;if(1===t){let t=e.touches[0];this.dispatchMouseEvent("mousemove",t.target,t)}else if(2===t){let{disableTouchZoom:t,minTouchZoomScale:i,maxTouchZoomScale:n}=this.mindMap.opt;if(t)return;i=-1===i?-1/0:i/100,n=-1===n?1/0:n/100;let s=e.touches[0],o=e.touches[1],a=s.clientX-o.clientX,r=s.clientY-o.clientY,h=Math.sqrt(Math.pow(a,2)+Math.pow(r,2)),{x:d,y:l}=this.mindMap.toPos(s.clientX,s.clientY),{x:c,y:m}=this.mindMap.toPos(o.clientX,o.clientY),u=(d+c)/2,f=(l+m)/2;const p=this.mindMap.view;if(!this.touchStartScaleView)return void(this.touchStartScaleView={distance:h,scale:p.scale,x:p.x,y:p.y,cx:u,cy:f});const x=this.touchStartScaleView;let g=x.scale*(h/x.distance);Math.abs(h-x.distance)<=10&&(g=x.scale),g=g<i?i:g>n?n:g;const z=1-g/x.scale;p.scale=g,p.x=x.x+(u-x.x)*z+(u-x.cx)*g,p.y=x.y+(f-x.y)*z+(f-x.cy)*g,p.transform(),this.mindMap.emit("scale",g)}}onTouchcancel(e){}onTouchend(e){if(this.dispatchMouseEvent("mouseup",e.target),1===this.touchesNum){this.clickNum++,setTimeout(()=>{this.clickNum=0,this.lastTouchStartPosition=null,this.lastTouchStartDistance=0},300);let e=this.singleTouchstartEvent;this.clickNum>1&&this.lastTouchStartDistance<=5&&(this.clickNum=0,this.dispatchMouseEvent("dblclick",e.target,e))}this.touchesNum=0,this.singleTouchstartEvent=null,this.touchStartScaleView=null}dispatchMouseEvent(e,t,i){let n={};i&&(n={screenX:i.screenX,screenY:i.screenY,clientX:i.clientX,clientY:i.clientY,which:1});let s=new MouseEvent(e,{view:document.defaultView,bubbles:!0,cancelable:!0,...n});t.dispatchEvent(s)}beforePluginRemove(){this.unBindEvent()}beforePluginDestroy(){this.unBindEvent()}}s.instanceName="touchEvent",t["a"]=s},"0bd5":function(e,t,i){"use strict";i.d(t,"d",(function(){return s})),i.d(t,"a",(function(){return o})),i.d(t,"h",(function(){return a})),i.d(t,"c",(function(){return h})),i.d(t,"g",(function(){return l})),i.d(t,"b",(function(){return c})),i.d(t,"f",(function(){return m})),i.d(t,"e",(function(){return u}));var n=i("d17d");const s=(e,t)=>e.getData("associativeLineTargets").findIndex(e=>e===t.getData("uid")),o=(e,t,i,n)=>{const s=5;let o=e+(i-e)/2,a=t,r=o,h=n;return Math.abs(e-i)<=s&&(o=e+(n-t)/2,r=o),Math.abs(t-n)<=s&&(o=e,a=t-(i-e)/2,r=i,h=a),[{x:o,y:a},{x:r,y:h}]},a=(e,t,i,n)=>`M ${e.x},${e.y} C ${i.x},${i.y} ${n.x},${n.y} ${t.x},${t.y}`,r=e=>{let{left:t,top:i,width:n,height:s}=e;return{right:t+n,bottom:i+s,left:t,top:i,width:n,height:s}},h=(e,t,i,n)=>{let s=o(e,t,i,n);return a({x:e,y:t},{x:i,y:n},s[0],s[1])},d=(e,t)=>{const{left:i,top:n,translateLeft:s,translateTop:o,width:a,height:r}=e,h=t.clientX,d=t.clientY,l=s+a/2,c=o+r/2,m=i+a/2,u=n+r/2,f=Math.atan(r/a),p=h-l,x=c-d,g=Math.atan2(x,p);let z=i+a,y=n+r;if(g<f&&g>=-f){const e=g*(a/2);return(g<f&&g>=0||g>=-f&&g<0)&&(y=u-e),{x:z,y:y,dir:"right",range:e}}if(g>=f&&g<Math.PI-f){y=n;let e=0;if(g<Math.PI/2-f&&g>=f){const t=r/2/g;e=-t,z=m+t}else if(g>=Math.PI/2-f&&g<Math.PI-f){const t=(l-h)/(c-d),i=r/2*t;e=i,z=m-i}return{x:z,y:y,dir:"top",range:e}}if(g<-f&&g>=f-Math.PI){let e=0;if(g>=f-Math.PI/2&&g<-f){const t=r/2/g;e=t,z=m-t}else if(g<f-Math.PI/2&&g>=f-Math.PI){const t=(l-h)/(c-d),i=r/2*t;e=-i,z=m+i}return{x:z,y:y,dir:"bottom",range:e}}z=i;const k=(c-d)/(l-h),w=k*(a/2);return(g>=-Math.PI&&g<f-Math.PI||g<Math.PI&&g>=Math.PI-f)&&(y=u-w),{x:z,y:y,dir:"left",range:w}},l=(e,t="right",i=0,n=null)=>{let{left:s,top:o,width:a,height:r}=e;if(n)return d(e,n);switch(t){case"left":return{x:s,y:o+r/2-i,dir:t};case"right":return{x:s+a,y:o+r/2-i,dir:t};case"top":return{x:s+a/2-i,y:o,dir:t};case"bottom":return{x:s+a/2-i,y:o+r,dir:t};default:break}},c=(e,t)=>{const i=r(e),s=r(t);let o="",a="";const h=Object(n["M"])({x:i.left,y:i.top,width:i.width,height:i.height},{x:s.left,y:s.top,width:s.width,height:s.height});switch(h){case"left-top":o="right",a="top";break;case"right-top":o="left",a="top";break;case"right-bottom":o="left",a="bottom";break;case"left-bottom":o="right",a="bottom";break;case"left":o="right",a="left";break;case"right":o="left",a="right";break;case"top":o="right",a="right";break;case"bottom":o="left",a="left";break;case"overlap":o="right",a="right";break;default:break}return[l(e,o),l(t,a)]},m=(e,t,i,n)=>{let r=s(i,n),h=[],d=i.getData("associativeLineTargetControlOffsets");if(d&&d[r]){let i=d[r];h=[{x:e.x+i[0].x,y:e.y+i[0].y},{x:t.x+i[1].x,y:t.y+i[1].y}]}else h=o(e.x,e.y,t.x,t.y);return{path:a(e,t,h[0],h[1]),controlPoints:h}},u=(e,t)=>{let i=o(e.x,e.y,t.x,t.y);return[{x:i[0].x-e.x,y:i[0].y-e.y},{x:i[1].x-t.x,y:i[1].y-t.y}]}},1135:function(e,t,i){"use strict";var n=i("6682"),s=i("d17d");const o="associative-line-text-edit-warp";function a(e){let t=this.associativeLineDraw.group();const i=()=>{this.activeLine&&this.activeLine[3]===e.node&&this.activeLine[4]===e.toNode||this.setActiveLine({...e,text:t})};return t.click(e=>{e.stopPropagation(),i()}),t.on("dblclick",e=>{e.stopPropagation(),i(),this.activeLine&&this.showEditTextBox(t)}),t}function r(e){if(this.mindMap.emit("before_show_text_edit"),this.mindMap.keyCommand.addShortcut("Enter",()=>{this.hideEditTextBox()}),!this.textEditNode){this.textEditNode=document.createElement("div"),this.textEditNode.className=o,this.textEditNode.style.cssText="position:fixed;box-sizing: border-box;background-color:#fff;box-shadow: 0 0 20px rgba(0,0,0,.5);padding: 3px 5px;margin-left: -5px;margin-top: -3px;outline: none; word-break: break-all;",this.textEditNode.setAttribute("contenteditable",!0),this.textEditNode.addEventListener("keyup",e=>{e.stopPropagation()}),this.textEditNode.addEventListener("click",e=>{e.stopPropagation()});const e=this.mindMap.opt.customInnerElsAppendTo||document.body;e.appendChild(this.textEditNode)}let[,,,t,i]=this.activeLine,{associativeLineTextFontSize:n,associativeLineTextFontFamily:a,associativeLineTextLineHeight:r}=this.getStyleConfig(t,i),{defaultAssociativeLineText:h,nodeTextEditZIndex:d}=this.mindMap.opt,l=this.mindMap.view.scale,c=this.getText(t,i),m=(c||h).split(/\n/gim);this.textEditNode.style.fontFamily=a,this.textEditNode.style.fontSize=n*l+"px",this.textEditNode.style.lineHeight=m.length>1?r:"normal",this.textEditNode.style.zIndex=d,this.textEditNode.innerHTML=m.join("<br>"),this.textEditNode.style.display="block",this.updateTextEditBoxPos(e),this.setIsShowTextEdit(!0),""===c||c===h?Object(s["rb"])(this.textEditNode):Object(s["x"])(this.textEditNode)}function h(e){this.showTextEdit=e,e?this.mindMap.keyCommand.stopCheckInSvg():this.mindMap.keyCommand.recoveryCheckInSvg()}function d(){if(!this.textEditNode)return;const e=this.mindMap.opt.customInnerElsAppendTo||document.body;e.removeChild(this.textEditNode)}function l(){this.hideEditTextBox()}function c(e){let t=e.node.getBoundingClientRect();this.textEditNode&&(this.textEditNode.style.minWidth=t.width+10+"px",this.textEditNode.style.minHeight=t.height+6+"px",this.textEditNode.style.left=t.left+"px",this.textEditNode.style.top=t.top+"px")}function m(){if(!this.showTextEdit)return;let[e,,t,i,n]=this.activeLine,o=Object(s["N"])(this.textEditNode.innerHTML),a=o===this.mindMap.opt.defaultAssociativeLineText;o=a?"":o,this.mindMap.execCommand("SET_NODE_DATA",i,{associativeLineText:{...i.getData("associativeLineText")||{},[n.getData("uid")]:o}}),this.textEditNode.style.display="none",this.textEditNode.innerHTML="",this.setIsShowTextEdit(!1),this.renderText(o,e,t,i,n),this.mindMap.emit("hide_text_edit")}function u(e,t){let i=e.getData("associativeLineText");return i&&i[t.getData("uid")]||""}function f(e,t,i,s,o){if(!e)return;let{associativeLineTextFontSize:a,associativeLineTextLineHeight:r}=this.getStyleConfig(s,o);i.clear();let h=e.replace(/\n$/g,"").split(/\n/gim);h.forEach((e,t)=>{""===e&&(e="\ufeff");let h=(new n["j"]).text(e);h.y(a*r*t),this.styleText(h,s,o),i.add(h)}),x(t,i)}function p(e,t,i){let{associativeLineTextColor:n,associativeLineTextFontSize:s,associativeLineTextFontFamily:o}=this.getStyleConfig(t,i);e.fill({color:n}).css({"font-family":o,"font-size":s+"px"})}function x(e,t){let i=e.length(),n=e.pointAt(i/2),{width:s,height:o}=t.bbox();t.x(n.x-s/2),t.y(n.y-o/2)}t["a"]={getText:u,createText:a,styleText:p,onScale:l,showEditTextBox:r,setIsShowTextEdit:h,removeTextEditEl:d,hideEditTextBox:m,updateTextEditBoxPos:c,renderText:f,updateTextPos:x}},1616:function(e,t,i){"use strict";var n=i("d17d"),s=i("50c9"),o=i("6ac9");class a{constructor({mindMap:e}){this.mindMap=e,this.isSearching=!1,this.searchText="",this.matchNodeList=[],this.currentIndex=-1,this.notResetSearchText=!1,this.isJumpNext=!1,this.bindEvent()}bindEvent(){this.onDataChange=this.onDataChange.bind(this),this.onModeChange=this.onModeChange.bind(this),this.mindMap.on("data_change",this.onDataChange),this.mindMap.on("mode_change",this.onModeChange)}unBindEvent(){this.mindMap.off("data_change",this.onDataChange),this.mindMap.off("mode_change",this.onModeChange)}onDataChange(){if(this.isJumpNext)return this.isJumpNext=!1,void this.search(this.searchText);this.notResetSearchText?this.notResetSearchText=!1:this.searchText=""}onModeChange(e){const t=e===o["a"].MODE.READONLY;!t&&this.isSearching&&this.matchNodeList[this.currentIndex]&&this.matchNodeList[this.currentIndex].closeHighlight()}search(e,t=(()=>{})){if(Object(n["bb"])(e))return this.endSearch();e=String(e),this.isSearching=!0,this.searchText===e||(this.searchText=e,this.doSearch()),this.searchNext(t),this.emitEvent()}updateMatchNodeList(e){this.matchNodeList=e,this.mindMap.emit("search_match_node_list_change",e)}endSearch(){this.isSearching&&(this.mindMap.opt.readonly&&this.matchNodeList[this.currentIndex]&&this.matchNodeList[this.currentIndex].closeHighlight(),this.searchText="",this.updateMatchNodeList([]),this.currentIndex=-1,this.notResetSearchText=!1,this.isSearching=!1,this.emitEvent())}doSearch(){this.clearHighlightOnReadonly(),this.updateMatchNodeList([]),this.currentIndex=-1;const{isOnlySearchCurrentRenderNodes:e}=this.mindMap.opt,t=e?this.mindMap.renderer.root:this.mindMap.renderer.renderTree;if(!t)return;const i=[];Object(n["d"])(t,t=>{let{richText:s,text:o,generalization:a}=e?t.getData():t.data;s&&(o=Object(n["O"])(o)),o.includes(this.searchText)&&i.push(t);const r=Object(n["z"])({generalization:a});r.forEach(t=>{let{richText:s,text:o,uid:a}=t;e&&!this.mindMap.renderer.findNodeByUid(a)||(s&&(o=Object(n["O"])(o)),o.includes(this.searchText)&&i.push({data:t}))})}),this.updateMatchNodeList(i)}isNodeInstance(e){return e instanceof s["a"]}searchNext(e,t){if(!this.isSearching||this.matchNodeList.length<=0)return;void 0!==t&&Number.isInteger(t)&&t>=0&&t<this.matchNodeList.length?this.currentIndex=t:this.currentIndex<this.matchNodeList.length-1?this.currentIndex++:this.currentIndex=0;const{readonly:i}=this.mindMap.opt;this.clearHighlightOnReadonly();const n=this.matchNodeList[this.currentIndex];this.notResetSearchText=!0;const s=this.isNodeInstance(n)?n.getData("uid"):n.data.uid;if(!s)return void e();const o=this.mindMap.renderer.findNodeByUid(s);this.mindMap.execCommand("GO_TARGET_NODE",s,t=>{this.isNodeInstance(n)||(this.matchNodeList[this.currentIndex]=t,this.updateMatchNodeList(this.matchNodeList)),e(),i&&t.highlight(),o&&(this.notResetSearchText=!1)})}clearHighlightOnReadonly(){const{readonly:e}=this.mindMap.opt;e&&this.matchNodeList.forEach(e=>{this.isNodeInstance(e)&&e.closeHighlight()})}jump(e,t=(()=>{})){this.searchNext(t,e)}replace(e,t=!1){if(null===e||void 0===e||!this.isSearching||this.matchNodeList.length<=0)return;this.isJumpNext=t,e=String(e);let i=this.matchNodeList[this.currentIndex];if(!i)return;const n=e.includes(this.searchText),s=this.getReplacedText(i,this.searchText,e);if(this.notResetSearchText=!0,i.setText(s,i.getData("richText")),n)return void this.updateMatchNodeList(this.matchNodeList);const o=this.matchNodeList.filter(e=>i!==e);this.updateMatchNodeList(o),this.currentIndex>this.matchNodeList.length-1?this.currentIndex=-1:this.currentIndex--,this.emitEvent()}replaceAll(e){if(null===e||void 0===e||!this.isSearching||this.matchNodeList.length<=0)return;e=String(e);const t=e.includes(this.searchText);this.notResetSearchText=!0,this.matchNodeList.forEach(t=>{const i=this.getReplacedText(t,this.searchText,e);if(this.isNodeInstance(t)){const e={text:i};this.mindMap.renderer.setNodeDataRender(t,e,!0)}else t.data.text=i}),this.mindMap.render(),this.mindMap.command.addHistory(),t?this.updateMatchNodeList(this.matchNodeList):this.endSearch()}getReplacedText(e,t,i){let{richText:s,text:o}=this.isNodeInstance(e)?e.getData():e.data;return s?Object(n["ob"])(o,t,i):o.replace(new RegExp(t,"g"),i)}emitEvent(){this.mindMap.emit("search_info_change",{currentIndex:this.currentIndex,total:this.matchNodeList.length})}beforePluginRemove(){this.unBindEvent()}beforePluginDestroy(){this.unBindEvent()}}a.instanceName="search",t["a"]=a},"1b0f":function(e,t,i){"use strict";var n=i("24db"),s=i("5008"),o=i.n(s),a=(i("521b"),i("d17d")),r=i("6ac9"),h=i("50c9"),d=i("1db0");let l=!1,c=["宋体, SimSun, Songti SC","微软雅黑, Microsoft YaHei","楷体, 楷体_GB2312, SimKai, STKaiti","黑体, SimHei, Heiti SC","隶书, SimLi","andale mono","arial, helvetica, sans-serif","arial black, avant garde","comic sans ms","impact, chicago","times new roman","sans-serif","serif"],m=new Array(100).fill(0).map((e,t)=>t+"px");const u="ql-editor";class f{constructor({mindMap:e,pluginOpt:t}){this.mindMap=e,this.pluginOpt=t,this.textEditNode=null,this.showTextEdit=!1,this.quill=null,this.range=null,this.lastRange=null,this.pasteUseRange=null,this.node=null,this.isInserting=!1,this.styleEl=null,this.cacheEditingText="",this.isCompositing=!1,this.textNodePaddingX=6,this.textNodePaddingY=4,this.mindMap.addEditNodeClass(u),this.initOpt(),this.extendQuill(),this.appendCss(),this.bindEvent(),this.handleDataToRichTextOnInit()}bindEvent(){this.onCompositionStart=this.onCompositionStart.bind(this),this.onCompositionUpdate=this.onCompositionUpdate.bind(this),this.onCompositionEnd=this.onCompositionEnd.bind(this),this.handleSetData=this.handleSetData.bind(this),window.addEventListener("compositionstart",this.onCompositionStart),window.addEventListener("compositionupdate",this.onCompositionUpdate),window.addEventListener("compositionend",this.onCompositionEnd),this.mindMap.on("before_update_data",this.handleSetData),this.mindMap.on("before_set_data",this.handleSetData)}unbindEvent(){window.removeEventListener("compositionstart",this.onCompositionStart),window.removeEventListener("compositionupdate",this.onCompositionUpdate),window.removeEventListener("compositionend",this.onCompositionEnd),this.mindMap.off("before_update_data",this.handleSetData),this.mindMap.off("before_set_data",this.handleSetData)}appendCss(){this.mindMap.appendCss("richText","\n      .smm-richtext-node-wrap {\n        word-break: break-all;\n        user-select: none;\n      }\n\n      .ql-editor .ql-align-left, \n      .smm-richtext-node-wrap .ql-align-left {\n        text-align: left;\n      }\n\n      .smm-richtext-node-wrap .ql-align-right {\n        text-align: right;\n      }\n\n      .smm-richtext-node-wrap .ql-align-center {\n        text-align: center;\n      }\n      ");let e=`\n      .${u} {\n        overflow: hidden;\n        padding: 0;\n        height: auto;\n        line-height: 1.2;\n        -webkit-user-select: text;\n        text-align: inherit;\n      }\n      \n      .ql-container {\n        height: auto;\n        font-size: inherit;\n      }\n\n      .ql-container.ql-snow {\n        border: none;\n      }\n    `;this.styleEl=document.createElement("style"),this.styleEl.type="text/css",this.styleEl.innerHTML=e,document.head.appendChild(this.styleEl)}initOpt(){this.pluginOpt.fontFamilyList&&Array.isArray(this.pluginOpt.fontFamilyList)&&(c=this.pluginOpt.fontFamilyList),this.pluginOpt.fontSizeList&&Array.isArray(this.pluginOpt.fontSizeList)&&(m=this.pluginOpt.fontSizeList)}extendQuill(){if(l)return;l=!0,this.extendFont([]),this.extendAlign();const e=n["a"].import("attributors/class/size");e.whitelist=m,n["a"].register(e,!0);const t=n["a"].import("attributors/style/size");t.whitelist=m,n["a"].register(t,!0)}extendFont(e=[],t=!1){c=t?[...e]:[...c,...e];const i=n["a"].import("attributors/class/font");i.whitelist=c,n["a"].register(i,!0);const s=n["a"].import("attributors/style/font");s.whitelist=c,n["a"].register(s,!0)}extendAlign(){const e=n["a"].import("formats/align");e.whitelist=["right","center","justify","left"],n["a"].register(e,!0)}showEditText({node:e,rect:t,isInserting:i,isFromKeyDown:n,isFromScale:s}){if(this.showTextEdit)return;let{customInnerElsAppendTo:o,nodeTextEditZIndex:r,textAutoWrapWidth:h,selectTextOnEnterEditText:d,transformRichTextOnEnterEdit:l,openRealtimeRenderOnNodeTextEdit:c,autoEmptyTextWhenKeydownEnterEdit:m}=this.mindMap.opt;h=e.hasCustomWidth()?e.customTextWidth:h,this.node=e,this.isInserting=i,t||(t=e._textData.node.node.getBoundingClientRect()),s||this.mindMap.emit("before_show_text_edit"),this.mindMap.renderer.textEdit.registerTmpShortcut();let u=e._textData.node,f=u.attr("data-width"),p=u.attr("data-height");const x=Math.ceil(t.width)/f,g=Math.ceil(t.height)/p;let z=this.textNodePaddingX,y=this.textNodePaddingY;if(!this.textEditNode){this.textEditNode=document.createElement("div"),this.textEditNode.classList.add("smm-richtext-node-edit-wrap"),this.textEditNode.style.cssText=`\n        position:fixed;\n        box-sizing: border-box;\n        ${c?"":"box-shadow: 0 0 20px rgba(0,0,0,.5);"}\n        outline: none;\n        word-break: break-all;\n        padding: ${y}px ${z}px;\n        line-height: 1.2;\n      `,this.textEditNode.addEventListener("click",e=>{e.stopPropagation()}),this.textEditNode.addEventListener("mousedown",e=>{e.stopPropagation()}),this.textEditNode.addEventListener("keydown",e=>{this.mindMap.renderer.textEdit.checkIsAutoEnterTextEditKey(e)&&e.stopPropagation()});const e=o||document.body;e.appendChild(this.textEditNode)}this.addNodeTextStyleToTextEditNode(e),this.textEditNode.style.marginLeft=`-${z*x}px`,this.textEditNode.style.marginTop=`-${y*g}px`,this.textEditNode.style.zIndex=r,c||(this.textEditNode.style.background=this.mindMap.renderer.textEdit.getBackground(e)),this.textEditNode.style.minWidth=f+2*z+"px",this.textEditNode.style.minHeight=p+"px",this.textEditNode.style.left=t.left+"px",this.textEditNode.style.top=t.top+"px",this.textEditNode.style.display="block",this.textEditNode.style.maxWidth=h+2*z+"px",this.textEditNode.style.transform=`scale(${x}, ${g})`,this.textEditNode.style.transformOrigin="left top";let k=e.getData("text");"function"===typeof l&&(k=l(k));const w=Object(a["bb"])(k),M=!e.getData("richText")&&!w;if(n&&m)this.textEditNode.innerHTML="";else if(M){let e=String(k).split(/\n/gim).join("<br>"),t=`<p>${e}</p>`;this.textEditNode.innerHTML=this.cacheEditingText||t}else this.textEditNode.innerHTML=this.cacheEditingText||k;this.initQuillEditor(),this.setQuillContainerMinHeight(p),this.setIsShowTextEdit(!0),this.focus(i||d&&!n?0:null),this.cacheEditingText=""}onOpenRealtimeRenderOnNodeTextEditConfigUpdate(e){this.textEditNode&&(this.textEditNode.style.background=e?"transparent":this.node?this.mindMap.renderer.textEdit.getBackground(this.node):"",this.textEditNode.style.boxShadow=e?"none":"0 0 20px rgba(0,0,0,.5)")}addNodeTextStyleToTextEditNode(e){const t=Object(a["J"])(e);Object.keys(t).forEach(e=>{this.textEditNode.style[e]=t[e]})}setQuillContainerMinHeight(e){document.querySelector("."+u).style.minHeight=e+"px"}updateTextEditNode(){if(!this.node)return;const e=this.node._textData.node,t=e.node.getBoundingClientRect(),i=e.attr("data-width"),n=e.attr("data-height");this.textEditNode.style.minWidth=i+2*this.textNodePaddingX+"px",this.textEditNode.style.minHeight=n+"px",this.textEditNode.style.left=t.left+"px",this.textEditNode.style.top=t.top+"px",this.setQuillContainerMinHeight(n)}removeTextEditEl(){if(!this.textEditNode)return;const e=this.mindMap.opt.customInnerElsAppendTo||document.body;e.removeChild(this.textEditNode)}getEditText(){return this.quill.container.firstChild.innerHTML.replace(/  +/g,e=>"&nbsp;".repeat(e.length))}hideEditText(e){if(!this.showTextEdit)return;const{beforeHideRichTextEdit:t}=this.mindMap.opt;"function"===typeof t&&t(this);const i=this.getEditText(),n=e&&e.length>0?e:[this.node],s=this.node;this.textEditNode.style.display="none",this.setIsShowTextEdit(!1),this.mindMap.emit("rich_text_selection_change",!1),this.node=null,this.isInserting=!1,n.forEach(e=>{this.mindMap.execCommand("SET_NODE_TEXT",e,i,!0),this.mindMap.render()}),this.mindMap.emit("hide_text_edit",this.textEditNode,n,s)}initQuillEditor(){this.quill=new n["a"](this.textEditNode,{modules:{toolbar:!1,keyboard:{bindings:{enter:{key:"Enter",handler:function(){}},shiftEnter:{key:"Enter",shiftKey:!0,handler:function(e,t){const i=Object.keys(t.format).reduce((e,i)=>(this.quill.scroll.query(i,d["Scope"].BLOCK)&&!Array.isArray(t.format[i])&&(e[i]=t.format[i]),e),{}),s=(new o.a).retain(e.index).delete(e.length).insert("\n",i);this.quill.updateContents(s,n["a"].sources.USER),this.quill.setSelection(e.index+1,n["a"].sources.SILENT),this.quill.focus(),Object.keys(t.format).forEach(e=>{null==i[e]&&(Array.isArray(t.format[e])||"code"!==e&&"link"!==e&&this.quill.format(e,t.format[e],n["a"].sources.USER))})}},tab:{key:9,handler:function(){}}}}},formats:["bold","italic","underline","strike","color","background","font","size","formula","align"],theme:"snow"}),this.quill.root.addEventListener("copy",e=>{e.preventDefault();const t=window.getSelection(),i=t.toString();try{const i=t.getRangeAt(0),n=document.createElement("div");n.appendChild(i.cloneContents());const s=Object(a["hb"])(n.innerHTML);e.clipboardData.setData("text/plain",s)}catch(n){e.clipboardData.setData("text/plain",i)}}),this.quill.on("selection-change",e=>{if(!this.isInserting)if(this.lastRange=this.range,this.range=null,e){this.pasteUseRange=e;let t=this.quill.getBounds(e.index,e.length),i=this.textEditNode.getBoundingClientRect(),n={left:t.left+i.left,top:t.top+i.top,right:t.right+i.left,bottom:t.bottom+i.top,width:t.width},s=this.quill.getFormat(e.index,e.length),o=!1;0==e.length?o=!1:(this.range=e,o=!0),this.mindMap.emit("rich_text_selection_change",o,n,s)}else this.mindMap.emit("rich_text_selection_change",!1,null,null)}),this.quill.on("text-change",()=>{this.mindMap.emit("node_text_edit_change",{node:this.node,text:this.getEditText(),richText:!0})}),this.quill.clipboard.addMatcher(Node.ELEMENT_NODE,(e,t)=>{let i=[],n=this.getPasteTextStyle();return t.ops.forEach(e=>{e.insert&&"string"===typeof e.insert&&i.push({attributes:{...n},insert:this.formatPasteText(e.insert)})}),t.ops=i,t}),this.quill.root.addEventListener("paste",e=>{e.clipboardData&&e.clipboardData.files&&e.clipboardData.files.length&&e.preventDefault()},!0)}getPasteTextStyle(){return this.pasteUseRange?this.quill.getFormat(this.pasteUseRange.index,this.pasteUseRange.length):{}}formatPasteText(e){const{isSmm:t,data:i}=Object(a["k"])(e);return t&&i[0]&&i[0].data?Object(a["O"])(i[0].data.text):e}onCompositionStart(){this.showTextEdit&&(this.isCompositing=!0)}onCompositionUpdate(){this.showTextEdit&&this.node&&this.mindMap.emit("node_text_edit_change",{node:this.node,text:this.getEditText(),richText:!0})}onCompositionEnd(){this.showTextEdit&&(this.isCompositing=!1)}setIsShowTextEdit(e){this.showTextEdit=e,e?this.mindMap.keyCommand.stopCheckInSvg():this.mindMap.keyCommand.recoveryCheckInSvg()}selectAll(){this.quill.setSelection(0,this.quill.getLength())}focus(e){const t=this.quill.getLength();this.quill.setSelection("number"===typeof e?e:t,t)}formatText(e={},t=!1){if(!this.range&&!this.lastRange)return;const i=!this.range,n=i?this.lastRange:this.range;if(t)this.quill.removeFormat(n.index,n.length);else{const{align:t,...i}=e;t&&this.quill.formatLine(n.index,n.length,"align",t),Object.keys(i).length>0&&this.quill.formatText(n.index,n.length,i)}i&&this.quill.setSelection(this.lastRange.index,this.lastRange.length)}removeFormat(){this.formatText({},!0)}formatRangeText(e,t={}){e&&this.quill.formatText(e.index,e.length,t)}formatAllText(e={}){this.quill.formatText(0,this.quill.getLength(),e)}normalStyleToRichTextStyle(e){const t={};return Object.keys(e).forEach(i=>{const n=e[i];switch(i){case"fontFamily":t.font=n;break;case"fontSize":t.size=n+"px";break;case"fontWeight":t.bold="bold"===n;break;case"fontStyle":t.italic="italic"===n;break;case"textDecoration":t.underline="underline"===n,t.strike="line-through"===n;break;case"color":t.color=n;break;case"textAlign":t.align=n;break;default:break}}),t}richTextStyleToNormalStyle(e){const t={};return Object.keys(e).forEach(i=>{const n=e[i];switch(i){case"font":t.fontFamily=n;break;case"size":t.fontSize=parseFloat(n);break;case"bold":t.fontWeight=n?"bold":"normal";break;case"italic":t.fontStyle=n?"italic":"normal";break;case"underline":t.textDecoration=n?"underline":"none";break;case"strike":t.textDecoration=n?"line-through":"none";break;case"color":t.color=n;break;case"align":t.textAlign=n;break;default:break}}),t}isHasRichTextStyle(e){const t=Object.keys(e);for(let i=0;i<t.length;i++){const e=t[i];if(r["h"].includes(e))return!0}return!1}checkNodeHasCustomRichTextStyle(e){const t=e instanceof h["a"]?e.getData():e;for(let i=0;i<r["h"].length;i++)if(void 0!==t[r["h"][i]])return!0;return!1}afterHandleData(){this.mindMap.command.clearHistory(),this.mindMap.command.addHistory(),this.mindMap.render()}handleDataToRichTextOnInit(){this.mindMap.renderer.renderTree?(this.handleSetData(this.mindMap.renderer.renderTree),this.afterHandleData()):this.mindMap.opt.data&&this.handleSetData(this.mindMap.opt.data)}transformAllNodesToNormalNode(){const e=this.mindMap.renderer.renderTree;e&&(Object(a["yb"])(e,null,e=>{if(e.data.richText&&(e.data.richText=!1,e.data.text=Object(a["O"])(e.data.text)),e.data){const t=Object(a["z"])(e.data);t.forEach(e=>{e.richText=!1,e.text=Object(a["O"])(e.text)})}},null,!0,0,0),this.afterHandleData())}handleDataToRichText(e){const t=e.richText;e.richText=!0,e.resetRichText=!0,t||(e.text=Object(a["V"])(e.text))}handleSetData(e){if(!e)return;const t=!e.smmVersion||"<"===Object(a["m"])(e.smmVersion,"0.13.0"),i=e=>{if(!e.data||e.data.richText&&!t||this.handleDataToRichText(e.data),e.data){const i=Object(a["z"])(e.data);i.forEach(e=>{e.richText&&!t||this.handleDataToRichText(e)})}e.children&&e.children.length>0&&Array.from(e.children).forEach(e=>{i(e)})};return i(e),e}beforePluginRemove(){this.transformAllNodesToNormalNode(),document.head.removeChild(this.styleEl),this.unbindEvent(),this.mindMap.removeAppendCss("richText"),this.mindMap.deleteEditNodeClass(u)}beforePluginDestroy(){document.head.removeChild(this.styleEl),this.unbindEvent(),this.mindMap.deleteEditNodeClass(u)}}f.instanceName="richText",t["a"]=f},"1e300":function(e,t,i){"use strict";var n=i("d17d"),s=i("6682"),o=i("4ba9"),a=i("ea0b"),r=i("6ac9"),h=i("3cd1");class d{constructor(e){this.mindMap=e.mindMap}async export(e,t=!0,i="思维导图",...s){if(this[e]){const o=await this[e](i,...s);return t&&Object(n["v"])(o,i+"."+e),o}return null}createTransformImgTaskList(e,t,i,s){const o=e.find(t);return o.map(async e=>{const t=s(e);if(/^data:/.test(t)||"none"===t)return;const o=await Object(n["W"])(t);e.attr(i,o)})}async getSvgData(e){let{exportPaddingX:t,exportPaddingY:i,errorHandler:o,resetCss:a,addContentToHeader:h,addContentToFooter:d,handleBeingExportSvg:l}=this.mindMap.opt,{svg:c,svgHTML:m,clipData:u}=this.mindMap.getSvgData({paddingX:t,paddingY:i,addContentToHeader:h,addContentToFooter:d,node:e});u&&(u.paddingX=t,u.paddingY=i);let f=!1;const p=this.createTransformImgTaskList(c,"image","href",e=>e.attr("href")||e.attr("xlink:href")),x=this.createTransformImgTaskList(c,"img","src",e=>e.attr("src")),g=[...p,...x];try{await Promise.all(g)}catch(z){o(r["b"].EXPORT_LOAD_IMAGE_ERROR,z)}if(this.mindMap.richText){const e=c.find("foreignObject");if(e.length>0&&(e[0].add(Object(s["i"])(`<style>${a}</style>`)),f=!0),this.mindMap.formula){const t=c.find(".ql-formula");if(t.length>0){const t=this.mindMap.formula.getStyleText();if(t){const i=document.createElement("style");i.innerHTML=t,Object(n["b"])(i),e[0].add(i),f=!0}}}}return"function"===typeof l&&(f=!0,c=l(c)),(g.length>0||f)&&(m=c.svg()),{node:c,str:m,clipData:u}}svgToPng(e,t,i=null,s=!1,o="image/png"){const{maxCanvasSize:a,minExportImgCanvasScale:r}=this.mindMap.opt;return new Promise((h,d)=>{const l=new Image;l.setAttribute("crossOrigin","anonymous"),l.onload=async()=>{try{const e=document.createElement("canvas"),d=Math.max(window.devicePixelRatio,r);let c=l.width,m=l.height,u=0,f=0;i&&(u=i.paddingX,f=i.paddingY,c=i.width+2*u,m=i.height+2*f);let p=0,x=0;const{backgroundImage:g}=this.mindMap.themeConfig;if(s&&g&&!t){const e=await new Promise(e=>{const t=new Image;t.onload=()=>{e([t.width,t.height])},t.onerror=()=>{e(null)},t.src=g});if(e){const t=c/m,i=e[0]/e[1];t>i?(p=c,x=c/i):(x=m,p=m*i)}}let z=1,y=1,k=(p||c)*d,w=(x||m)*d;if(k>a||w>a){let e=null,t=null;k>a?e=a:w>a&&(t=a);const i=Object(n["pb"])(k,w,e,t);z=i[0]/k,y=i[1]/w,k=i[0],w=i[1]}e.width=k,e.height=w;const M=k/d,b=w/d;e.style.width=M+"px",e.style.height=b+"px";const E=e.getContext("2d");E.scale(d,d),t||await this.drawBackgroundToCanvas(E,M,b);const v=(p>0?(p-c)/2:0)*z,T=(x>0?(x-m)/2:0)*y;i?E.drawImage(l,i.left,i.top,i.width,i.height,u*z+v,f*y+T,i.width*z,i.height*y):E.drawImage(l,v,T,c*z,m*y),h(e.toDataURL(o))}catch(e){d(e)}},l.onerror=e=>{d(e)},l.src=e})}drawBackgroundToCanvas(e,t,i){return new Promise((n,s)=>{const{backgroundColor:a="#fff",backgroundImage:r,backgroundRepeat:h="no-repeat",backgroundPosition:d="center center",backgroundSize:l="cover"}=this.mindMap.themeConfig;e.save(),e.rect(0,0,t,i),e.fillStyle=a,e.fill(),e.restore(),r&&"none"!==r?(e.save(),Object(o["a"])(e,t,i,r,{backgroundRepeat:h,backgroundPosition:d,backgroundSize:l},t=>{t?s(t):n(),e.restore()})):n()})}drawBackgroundToSvg(e){return new Promise(async t=>{const{backgroundColor:i="#fff",backgroundImage:s,backgroundRepeat:o="repeat"}=this.mindMap.themeConfig;if(e.css("background-color",i),s&&"none"!==s){const i=await Object(n["W"])(s);e.css("background-image",`url(${i})`),e.css("background-repeat",o),t()}else t()})}async _image(e,t,i=!1,n=null,s=!1){this.mindMap.renderer.textEdit.hideEditTextBox(),this.handleNodeExport(n);const{str:o,clipData:a}=await this.getSvgData(n),r=await this.fixSvgStrAndToBlob(o),h=await this.svgToPng(r,i,a,s,e);return h}async png(...e){const t=await this._image("image/png",...e);return t}async jpg(...e){const t=await this._image("image/jpg",...e);return t}handleNodeExport(e){if(e&&e.getData("isActive")){e.deactivate();const{alwaysShowExpandBtn:t,notShowExpandBtn:i}=this.mindMap.opt;t||i||!e.getData("expand")||e.removeExpandBtn()}}async pdf(e,t=!1,i=!1){if(!this.mindMap.doExportPDF)throw new Error("请注册ExportPDF插件");const n=await this.png(e,t,null,i),s=await this.mindMap.doExportPDF.pdf(n);return s}async xmind(e){if(!this.mindMap.doExportXMind)throw new Error("请注册ExportXMind插件");const t=this.mindMap.getData(),i=await this.mindMap.doExportXMind.xmind(t,e),s=await Object(n["kb"])(i);return s}async svg(e){this.mindMap.renderer.textEdit.hideEditTextBox();const{node:t}=await this.getSvgData();t.first().before(Object(s["i"])(`<title>${e}</title>`)),await this.drawBackgroundToSvg(t);const i=t.svg(),n=await this.fixSvgStrAndToBlob(i);return n}async fixSvgStrAndToBlob(e){e=Object(n["mb"])(e),e=Object(n["U"])(e);const t=new Blob([e],{type:"image/svg+xml"}),i=await Object(n["kb"])(t);return i}async json(e,t=!0){const i=this.mindMap.getData(t),s=JSON.stringify(i),o=new Blob([s]),a=await Object(n["kb"])(o);return a}async smm(e,t){const i=await this.json(e,t);return i}async md(){const e=this.mindMap.getData(),t=Object(a["a"])(e),i=new Blob([t]),s=await Object(n["kb"])(i);return s}async txt(){const e=this.mindMap.getData(),t=Object(h["a"])(e),i=new Blob([t]),s=await Object(n["kb"])(i);return s}}d.instanceName="doExport",t["a"]=d},"395a":function(e,t,i){"use strict";var n=i("d17d");const s=["rgb(255, 213, 73)","rgb(255, 136, 126)","rgb(107, 225, 141)","rgb(151, 171, 255)","rgb(129, 220, 242)","rgb(255, 163, 125)","rgb(152, 132, 234)"];class o{constructor({mindMap:e}){this.mindMap=e}updateRainLinesConfig(e={}){const t=this.mindMap.opt.rainbowLinesConfig||{};t.open=!!e.open,t.colorsList=Array.isArray(e.colorsList)?e.colorsList:[],this.mindMap.opt.rainbowLinesConfig.open&&this.removeNodeLineColor(),this.mindMap.render()}removeNodeLineColor(){const e=this.mindMap.renderer.renderTree;e&&(Object(n["yb"])(e,null,e=>{delete e.data.lineColor},null,!0),this.mindMap.command.addHistory())}getSecondLayerAncestor(e){if(0===e.layerIndex)return null;if(1===e.layerIndex)return e;{let t=null,i=e.parent;while(i){if(1===i.layerIndex)return i;i=i.parent}return t}}getColorsList(){const{rainbowLinesConfig:e}=this.mindMap.opt;return e&&Array.isArray(e.colorsList)&&e.colorsList.length>0?e.colorsList:[...s]}getNodeColor(e){const{rainbowLinesConfig:t}=this.mindMap.opt;if(!t||!t.open)return"";const i=this.getSecondLayerAncestor(e);if(!i)return;const s=Object(n["G"])(i),o=this.getColorsList();return o[s%o.length]}}o.instanceName="rainbowLines",t["a"]=o},"4a3f":function(e,t,i){"use strict";var n=i("ba59"),s=i("d17d");class o{constructor(e){this.mindMap=e.mindMap}async pdf(e){return new Promise((t,i)=>{const o=new Image;o.onload=async()=>{const i=o.width,a=o.height,r=await n["PDFDocument"].create(),h=r.addPage();h.setSize(i,a);const d=await r.embedPng(e);h.drawImage(d,{x:0,y:0,width:i,height:a});const l=await r.save(),c=new Blob([l]),m=await Object(s["kb"])(c);t(m)},o.onerror=e=>{i(e)},o.src=e})}}o.instanceName="doExportPDF",t["a"]=o},"4dc1":function(e,t,i){"use strict";var n=i("d17d"),s=i("1f66");class o{constructor({mindMap:e}){this.mindMap=e,this.rect=null,this.isMousedown=!1,this.mouseDownX=0,this.mouseDownY=0,this.mouseMoveX=0,this.mouseMoveY=0,this.isSelecting=!1,this.cacheActiveList=[],this.autoMove=new s["a"](e),this.bindEvent()}bindEvent(){this.onMousedown=this.onMousedown.bind(this),this.onMousemove=this.onMousemove.bind(this),this.onMouseup=this.onMouseup.bind(this),this.checkInNodes=Object(n["wb"])(this.checkInNodes,300,this),this.mindMap.on("mousedown",this.onMousedown),this.mindMap.on("mousemove",this.onMousemove),this.mindMap.on("mouseup",this.onMouseup),this.mindMap.on("node_mouseup",this.onMouseup)}unBindEvent(){this.mindMap.off("mousedown",this.onMousedown),this.mindMap.off("mousemove",this.onMousemove),this.mindMap.off("mouseup",this.onMouseup),this.mindMap.off("node_mouseup",this.onMouseup)}onMousedown(e){const{readonly:t,mousedownEventPreventDefault:i}=this.mindMap.opt;if(t)return;let{useLeftKeySelectionRightKeyDrag:n}=this.mindMap.opt;if(!e.ctrlKey&&!e.metaKey&&(n?1!==e.which:3!==e.which))return;i&&e.preventDefault(),this.isMousedown=!0,this.cacheActiveList=[...this.mindMap.renderer.activeNodeList];let{x:s,y:o}=this.mindMap.toPos(e.clientX,e.clientY);this.mouseDownX=s,this.mouseDownY=o,this.createRect(s,o)}onMousemove(e){if(this.mindMap.opt.readonly)return;if(!this.isMousedown)return;let{x:t,y:i}=this.mindMap.toPos(e.clientX,e.clientY);this.mouseMoveX=t,this.mouseMoveY=i,Math.abs(t-this.mouseDownX)<=10&&Math.abs(i-this.mouseDownY)<=10||(this.autoMove.clearAutoMoveTimer(),this.autoMove.onMove(e.clientX,e.clientY,()=>{this.isSelecting=!0,this.rect&&this.rect.plot([[this.mouseDownX,this.mouseDownY],[this.mouseMoveX,this.mouseDownY],[this.mouseMoveX,this.mouseMoveY],[this.mouseDownX,this.mouseMoveY]]),this.checkInNodes()},(e,t)=>{switch(e){case"left":this.mouseDownX+=t;break;case"top":this.mouseDownY+=t;break;case"right":this.mouseDownX-=t;break;case"bottom":this.mouseDownY-=t;break;default:break}}))}onMouseup(){this.mindMap.opt.readonly||this.isMousedown&&(this.checkTriggerNodeActiveEvent(),this.autoMove.clearAutoMoveTimer(),this.isMousedown=!1,this.cacheActiveList=[],this.rect&&this.rect.remove(),this.rect=null,setTimeout(()=>{this.isSelecting=!1},0))}checkTriggerNodeActiveEvent(){let e=this.cacheActiveList.length!==this.mindMap.renderer.activeNodeList.length,t=!1;if(!e)for(let i=0;i<this.cacheActiveList.length;i++){let e=this.cacheActiveList[i];if(!this.mindMap.renderer.activeNodeList.find(t=>t.getData("uid")===e.getData("uid"))){t=!0;break}}(e||t)&&this.mindMap.renderer.emitNodeActiveEvent()}createRect(e,t){this.rect&&this.rect.remove(),this.rect=this.mindMap.svg.polygon().stroke({color:"#0984e3"}).fill({color:"rgba(9,132,227,0.3)"}).plot([[e,t]])}checkInNodes(){let{scaleX:e,scaleY:t,translateX:i,translateY:s}=this.mindMap.draw.transform(),o=Math.min(this.mouseDownX,this.mouseMoveX),a=Math.min(this.mouseDownY,this.mouseMoveY),r=Math.max(this.mouseDownX,this.mouseMoveX),h=Math.max(this.mouseDownY,this.mouseMoveY);const d=d=>{let{left:l,top:c,width:m,height:u}=d,f=(l+m)*e+i,p=(c+u)*t+s;if(l=l*e+i,c=c*t+s,Object(n["l"])(o,r,a,h,l,f,c,p)){if(d.getData("isActive"))return;this.mindMap.renderer.addNodeToActiveList(d),this.mindMap.renderer.emitNodeActiveEvent()}else if(d.getData("isActive")){if(!d.getData("isActive"))return;this.mindMap.renderer.removeNodeFromActiveList(d),this.mindMap.renderer.emitNodeActiveEvent()}};Object(n["d"])(this.mindMap.renderer.root,e=>{d(e),e._generalizationList&&e._generalizationList.length>0&&e._generalizationList.forEach(e=>{d(e.generalizationNode)})})}hasSelectRange(){return this.isSelecting}beforePluginRemove(){this.unBindEvent()}beforePluginDestroy(){this.unBindEvent()}}o.instanceName="select",t["a"]=o},"58c9":function(e,t,i){"use strict";var n=i("6682"),s=i("d17d"),o=i("586a"),a=i.n(o);class r{constructor(e={}){this.mindMap=e.mindMap,this.lineSpacing=0,this.textSpacing=0,this.angle=0,this.text="",this.textStyle={},this.watermarkDraw=null,this.isInExport=!1,this.maxLong=this.getMaxLong(),this.updateWatermark(this.mindMap.opt.watermarkConfig||{}),this.bindEvent()}getMaxLong(){return Math.sqrt(Math.pow(this.mindMap.width,2)+Math.pow(this.mindMap.height,2))}bindEvent(){this.onResize=this.onResize.bind(this),this.mindMap.on("resize",this.onResize)}unBindEvent(){this.mindMap.off("resize",this.onResize)}onResize(){this.maxLong=this.getMaxLong(),this.draw()}createContainer(){this.watermarkDraw||(this.watermarkDraw=(new n["d"]).css({"pointer-events":"none","user-select":"none"}).addClass("smm-water-mark-container"),this.updateLayer())}updateLayer(){if(!this.watermarkDraw)return;const{belowNode:e}=this.mindMap.opt.watermarkConfig;e?this.watermarkDraw.insertBefore(this.mindMap.draw):this.mindMap.svg.add(this.watermarkDraw)}removeContainer(){this.watermarkDraw&&(this.watermarkDraw.remove(),this.watermarkDraw=null)}hasWatermark(){return!!this.text.trim()}handleConfig({text:e,lineSpacing:t,textSpacing:i,angle:n,textStyle:s}){this.text=void 0===e?"":String(e).trim(),this.lineSpacing="number"===typeof t&&t>0?t:100,this.textSpacing="number"===typeof i&&i>0?i:100,this.angle="number"===typeof n&&n>=0&&n<=90?n:30,this.textStyle=Object.assign(this.textStyle,s||{})}clear(){this.watermarkDraw&&this.watermarkDraw.clear()}draw(){this.clear();const{onlyExport:e}=this.mindMap.opt.watermarkConfig;if(e&&!this.isInExport)return;if(!this.hasWatermark())return void this.removeContainer();this.createContainer();let t=0;while(t<this.mindMap.width)this.drawText(t),t+=this.lineSpacing/Math.sin(Object(s["u"])(this.angle));let i=this.lineSpacing/Math.cos(Object(s["u"])(this.angle))||this.lineSpacing,n=i;while(n<this.mindMap.height)this.drawText(0,n),n+=i}drawText(e,t){let i=Math.min(this.maxLong,(this.mindMap.width-e)/Math.cos(Object(s["u"])(this.angle))),o=new n["d"],a=null,r=0,h=-1;while(r<i){let e=(new n["j"]).text(this.text);o.add(e),e.transform({translateX:r}),this.setTextStyle(e),a=o.bbox(),-1===h&&(h=a.height),r=a.width+this.textSpacing}let d={rotate:this.angle,origin:"top left",translateX:e,translateY:h};void 0!==t&&(d.translateY=t+h),o.transform(d),this.watermarkDraw.add(o)}setTextStyle(e){Object.keys(this.textStyle).forEach(t=>{let i=this.textStyle[t];"color"===t?e.fill(i):e.css(Object(s["e"])(t),i)})}updateWatermark(e){this.mindMap.opt.watermarkConfig=a()(this.mindMap.opt.watermarkConfig,e),this.updateLayer(),this.handleConfig(e),this.draw()}beforePluginRemove(){this.unBindEvent(),this.removeContainer()}beforePluginDestroy(){this.unBindEvent(),this.removeContainer()}}r.instanceName="watermark",t["a"]=r},"627d":function(e,t,i){"use strict";var n=i("6ac9");class s{constructor(e){this.opt=e,this.mindMap=e.mindMap,this.init()}init(){this.updateNodeTree=this.updateNodeTree.bind(this),this.afterExecCommand=this.afterExecCommand.bind(this),this.layoutChange=this.layoutChange.bind(this),this.mindMap.opt.data&&this.isMindMapLayout()&&this.updateNodeTree(this.mindMap.opt.data),this.mindMap.on("layout_change",this.layoutChange),this.mindMap.on("afterExecCommand",this.afterExecCommand),this.mindMap.on("before_update_data",this.updateNodeTree),this.mindMap.on("before_set_data",this.updateNodeTree)}restore(){this.mindMap.off("layout_change",this.layoutChange),this.mindMap.off("afterExecCommand",this.afterExecCommand),this.mindMap.off("before_update_data",this.updateNodeTree),this.mindMap.off("before_set_data",this.updateNodeTree)}afterExecCommand(e){this.isMindMapLayout()&&["BACK","FORWARD","INSERT_NODE","INSERT_MULTI_NODE","INSERT_CHILD_NODE","INSERT_MULTI_CHILD_NODE","INSERT_PARENT_NODE","UP_NODE","DOWN_NODE","MOVE_UP_ONE_LEVEL","INSERT_AFTER","INSERT_BEFORE","MOVE_NODE_TO","REMOVE_NODE","REMOVE_CURRENT_NODE","PASTE_NODE","CUT_NODE"].includes(e)&&this.updateRenderTree()}layoutChange(e){e===n["a"].LAYOUT.MIND_MAP&&this.updateRenderTree()}updateRenderTree(){this.updateNodeTree(this.mindMap.renderer.renderTree)}updateNodeTree(e){if(!this.isMindMapLayout())return;const t=e,i=t.children.length;if(i<=0)return;const s=Math.ceil(i/2);t.children.forEach((e,t)=>{e.data.dir=t+1<=s?n["a"].LAYOUT_GROW_DIR.RIGHT:n["a"].LAYOUT_GROW_DIR.LEFT})}isMindMapLayout(){return this.mindMap.opt.layout===n["a"].LAYOUT.MIND_MAP}beforePluginRemove(){this.restore()}beforePluginDestroy(){this.restore()}}s.instanceName="mindMapLayoutPro",t["a"]=s},"860e":function(e,t,i){"use strict";var n=i("1e30");class s{constructor(e){this.mindMap=e.mindMap}async xmind(e,t){const i=await n["a"].transformToXmind(e,t);return i}getXmind(){return n["a"]}}s.instanceName="doExportXMind",t["a"]=s},"91c7":function(e,t,i){"use strict";var n=i("d17d"),s=i("6ac9");class o{constructor(e){this.mindMap=e.mindMap,this.scrollbarWrapSize={width:0,height:0},this.chartHeight=0,this.chartWidth=0,this.reset(),this.bindEvent()}reset(){this.currentScrollType="",this.isMousedown=!1,this.mousedownPos={x:0,y:0},this.mousedownScrollbarPos=0}bindEvent(){this.onMousemove=this.onMousemove.bind(this),this.onMouseup=this.onMouseup.bind(this),this.updateScrollbar=this.updateScrollbar.bind(this),this.updateScrollbar=Object(n["wb"])(this.updateScrollbar,16,this),this.mindMap.on("mousemove",this.onMousemove),this.mindMap.on("mouseup",this.onMouseup),this.mindMap.on("node_tree_render_end",this.updateScrollbar),this.mindMap.on("view_data_change",this.updateScrollbar),this.mindMap.on("resize",this.updateScrollbar)}unBindEvent(){this.mindMap.off("mousemove",this.onMousemove),this.mindMap.off("mouseup",this.onMouseup),this.mindMap.off("node_tree_render_end",this.updateScrollbar),this.mindMap.off("view_data_change",this.updateScrollbar),this.mindMap.off("resize",this.updateScrollbar)}updateScrollbar(){if(this.isMousedown)return;const e=this.calculationScrollbar();this.emitEvent(e)}emitEvent(e){this.mindMap.emit("scrollbar_change",e)}setScrollBarWrapSize(e,t){this.scrollbarWrapSize.width=e,this.scrollbarWrapSize.height=t}calculationScrollbar(){const e=this.mindMap.draw.rbox(),t=this.mindMap.elRect;e.x-=t.left,e.y-=t.top;const i=this.mindMap.height,n=i/2,s=e.height+2*n;this.chartHeight=s;const o=e.y-n,a=Math.min(i/s*100,100);let r=-o/s*100;r<0&&(r=0),r>100-a&&(r=100-a);const h=this.mindMap.width,d=h/2,l=e.width+2*d;this.chartWidth=l;const c=e.x-d,m=Math.min(h/l*100,100);let u=-c/l*100;u<0&&(u=0),u>100-m&&(u=100-m);const f={vertical:{top:r,height:a},horizontal:{left:u,width:m}};return f}onMousedown(e,t){e.preventDefault(),e.stopPropagation(),this.currentScrollType=t,this.isMousedown=!0,this.mousedownPos={x:e.clientX,y:e.clientY};const i=window.getComputedStyle(e.target);t===s["a"].SCROLL_BAR_DIR.VERTICAL?this.mousedownScrollbarPos=Number.parseFloat(i.top):this.mousedownScrollbarPos=Number.parseFloat(i.left)}onMousemove(e){if(this.isMousedown)if(e.preventDefault(),e.stopPropagation(),this.currentScrollType===s["a"].SCROLL_BAR_DIR.VERTICAL){const t=e.clientY-this.mousedownPos.y+this.mousedownScrollbarPos;this.updateMindMapView(s["a"].SCROLL_BAR_DIR.VERTICAL,t)}else{const t=e.clientX-this.mousedownPos.x+this.mousedownScrollbarPos;this.updateMindMapView(s["a"].SCROLL_BAR_DIR.HORIZONTAL,t)}}onMouseup(){this.isMousedown=!1,this.reset()}updateMindMapView(e,t){const i=this.calculationScrollbar(),n=this.mindMap.draw.transform(),o=this.mindMap.draw.rbox(),a=this.mindMap.renderer.root.group.rbox(),r=this.mindMap.renderer.layout.getRootCenterOffset(a.width,a.height);if(e===s["a"].SCROLL_BAR_DIR.VERTICAL){let e=t;e<=0&&(e=0);const s=(100-i.vertical.height)/100*this.scrollbarWrapSize.height;e>=s&&(e=s);const h=e/this.scrollbarWrapSize.height*100,d=-h/100*this.chartHeight,l=a.y-o.y,c=this.mindMap.height/2,m=d+l-c*n.scaleY+c-r.y*n.scaleY+(this.mindMap.height-this.mindMap.initHeight)/2*n.scaleY;this.mindMap.view.translateYTo(m),this.emitEvent({horizontal:i.horizontal,vertical:{top:h,height:i.vertical.height}})}else{let e=t;e<=0&&(e=0);const s=(100-i.horizontal.width)/100*this.scrollbarWrapSize.width;e>=s&&(e=s);const h=e/this.scrollbarWrapSize.width*100,d=-h/100*this.chartWidth,l=a.x-o.x,c=this.mindMap.width/2,m=d+l-c*n.scaleX+c-r.x*n.scaleX+(this.mindMap.width-this.mindMap.initWidth)/2*n.scaleX;this.mindMap.view.translateXTo(m),this.emitEvent({vertical:i.vertical,horizontal:{left:h,width:i.horizontal.width}})}}onClick(e,t){let i=0;i=t===s["a"].SCROLL_BAR_DIR.VERTICAL?e.clientY-e.currentTarget.getBoundingClientRect().top:e.clientX-e.currentTarget.getBoundingClientRect().left,this.updateMindMapView(t,i)}beforePluginRemove(){this.unBindEvent()}beforePluginDestroy(){this.unBindEvent()}}o.instanceName="scrollbar",t["a"]=o},"9aa6":function(e,t,i){"use strict";var n=i("d17d");class s{constructor({mindMap:e}){this.mindMap=e,this.isInPainter=!1,this.painterNode=null,this.bindEvent()}bindEvent(){this.painterOneNode=this.painterOneNode.bind(this),this.onEndPainter=this.onEndPainter.bind(this),this.mindMap.on("node_click",this.painterOneNode),this.mindMap.on("draw_click",this.onEndPainter)}unBindEvent(){this.mindMap.off("node_click",this.painterOneNode),this.mindMap.off("draw_click",this.onEndPainter)}startPainter(){if(this.mindMap.opt.readonly)return;let e=this.mindMap.renderer.activeNodeList;e.length<=0||(this.painterNode=e[0],this.isInPainter=!0,this.mindMap.emit("painter_start"))}endPainter(){this.painterNode=null,this.isInPainter=!1}onEndPainter(){this.isInPainter&&(this.endPainter(),this.mindMap.emit("painter_end"))}painterOneNode(e){if(!e||!this.isInPainter||!this.painterNode||!e||e.uid===this.painterNode.uid)return;let t={};this.mindMap.opt.onlyPainterNodeCustomStyles||(t={...this.painterNode.effectiveStyles});const i=this.painterNode.getData();Object.keys(i).forEach(e=>{Object(n["g"])(e)&&(t[e]=i[e])}),this.mindMap.renderer._handleRemoveCustomStyles(e.getData()),e.setStyles(t)}beforePluginRemove(){this.unBindEvent()}beforePluginDestroy(){this.unBindEvent()}}s.instanceName="painter",t["a"]=s},a7ef:function(e,t,i){"use strict";var n=i("eeb5"),s=i.n(n),o=i("24db"),a=i("d17d");const r=e=>`\n@font-face {\n  font-family: 'KaTeX_AMS';\n  src: url(${e}fonts/KaTeX_AMS-Regular.woff2) format('woff2'), url(${e}fonts/KaTeX_AMS-Regular.woff) format('woff'), url(${e}fonts/KaTeX_AMS-Regular.ttf) format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'KaTeX_Caligraphic';\n  src: url(${e}fonts/KaTeX_Caligraphic-Bold.woff2) format('woff2'), url(${e}fonts/KaTeX_Caligraphic-Bold.woff) format('woff'), url(${e}fonts/KaTeX_Caligraphic-Bold.ttf) format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'KaTeX_Caligraphic';\n  src: url(${e}fonts/KaTeX_Caligraphic-Regular.woff2) format('woff2'), url(${e}fonts/KaTeX_Caligraphic-Regular.woff) format('woff'), url(${e}fonts/KaTeX_Caligraphic-Regular.ttf) format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'KaTeX_Fraktur';\n  src: url(${e}fonts/KaTeX_Fraktur-Bold.woff2) format('woff2'), url(${e}fonts/KaTeX_Fraktur-Bold.woff) format('woff'), url(${e}fonts/KaTeX_Fraktur-Bold.ttf) format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'KaTeX_Fraktur';\n  src: url(${e}fonts/KaTeX_Fraktur-Regular.woff2) format('woff2'), url(${e}fonts/KaTeX_Fraktur-Regular.woff) format('woff'), url(${e}fonts/KaTeX_Fraktur-Regular.ttf) format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'KaTeX_Main';\n  src: url(${e}fonts/KaTeX_Main-Bold.woff2) format('woff2'), url(${e}fonts/KaTeX_Main-Bold.woff) format('woff'), url(${e}fonts/KaTeX_Main-Bold.ttf) format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'KaTeX_Main';\n  src: url(${e}fonts/KaTeX_Main-BoldItalic.woff2) format('woff2'), url(${e}fonts/KaTeX_Main-BoldItalic.woff) format('woff'), url(${e}fonts/KaTeX_Main-BoldItalic.ttf) format('truetype');\n  font-weight: bold;\n  font-style: italic;\n}\n@font-face {\n  font-family: 'KaTeX_Main';\n  src: url(${e}fonts/KaTeX_Main-Italic.woff2) format('woff2'), url(${e}fonts/KaTeX_Main-Italic.woff) format('woff'), url(${e}fonts/KaTeX_Main-Italic.ttf) format('truetype');\n  font-weight: normal;\n  font-style: italic;\n}\n@font-face {\n  font-family: 'KaTeX_Main';\n  src: url(${e}fonts/KaTeX_Main-Regular.woff2) format('woff2'), url(${e}fonts/KaTeX_Main-Regular.woff) format('woff'), url(${e}fonts/KaTeX_Main-Regular.ttf) format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'KaTeX_Math';\n  src: url(${e}fonts/KaTeX_Math-BoldItalic.woff2) format('woff2'), url(${e}fonts/KaTeX_Math-BoldItalic.woff) format('woff'), url(${e}fonts/KaTeX_Math-BoldItalic.ttf) format('truetype');\n  font-weight: bold;\n  font-style: italic;\n}\n@font-face {\n  font-family: 'KaTeX_Math';\n  src: url(${e}fonts/KaTeX_Math-Italic.woff2) format('woff2'), url(${e}fonts/KaTeX_Math-Italic.woff) format('woff'), url(${e}fonts/KaTeX_Math-Italic.ttf) format('truetype');\n  font-weight: normal;\n  font-style: italic;\n}\n@font-face {\n  font-family: 'KaTeX_SansSerif';\n  src: url(${e}fonts/KaTeX_SansSerif-Bold.woff2) format('woff2'), url(${e}fonts/KaTeX_SansSerif-Bold.woff) format('woff'), url(${e}fonts/KaTeX_SansSerif-Bold.ttf) format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'KaTeX_SansSerif';\n  src: url(${e}fonts/KaTeX_SansSerif-Italic.woff2) format('woff2'), url(${e}fonts/KaTeX_SansSerif-Italic.woff) format('woff'), url(${e}fonts/KaTeX_SansSerif-Italic.ttf) format('truetype');\n  font-weight: normal;\n  font-style: italic;\n}\n@font-face {\n  font-family: 'KaTeX_SansSerif';\n  src: url(${e}fonts/KaTeX_SansSerif-Regular.woff2) format('woff2'), url(${e}fonts/KaTeX_SansSerif-Regular.woff) format('woff'), url(${e}fonts/KaTeX_SansSerif-Regular.ttf) format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'KaTeX_Script';\n  src: url(${e}fonts/KaTeX_Script-Regular.woff2) format('woff2'), url(${e}fonts/KaTeX_Script-Regular.woff) format('woff'), url(${e}fonts/KaTeX_Script-Regular.ttf) format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'KaTeX_Size1';\n  src: url(${e}fonts/KaTeX_Size1-Regular.woff2) format('woff2'), url(${e}fonts/KaTeX_Size1-Regular.woff) format('woff'), url(${e}fonts/KaTeX_Size1-Regular.ttf) format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'KaTeX_Size2';\n  src: url(${e}fonts/KaTeX_Size2-Regular.woff2) format('woff2'), url(${e}fonts/KaTeX_Size2-Regular.woff) format('woff'), url(${e}fonts/KaTeX_Size2-Regular.ttf) format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'KaTeX_Size3';\n  src: url(${e}fonts/KaTeX_Size3-Regular.woff2) format('woff2'), url(${e}fonts/KaTeX_Size3-Regular.woff) format('woff'), url(${e}fonts/KaTeX_Size3-Regular.ttf) format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'KaTeX_Size4';\n  src: url(${e}fonts/KaTeX_Size4-Regular.woff2) format('woff2'), url(${e}fonts/KaTeX_Size4-Regular.woff) format('woff'), url(${e}fonts/KaTeX_Size4-Regular.ttf) format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'KaTeX_Typewriter';\n  src: url(${e}fonts/KaTeX_Typewriter-Regular.woff2) format('woff2'), url(${e}fonts/KaTeX_Typewriter-Regular.woff) format('woff'), url(${e}fonts/KaTeX_Typewriter-Regular.ttf) format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n    `,h=()=>'\n.katex {\n  font: normal 1.21em KaTeX_Main, Times New Roman, serif;\n  line-height: 1.2;\n  text-indent: 0;\n  text-rendering: auto;\n}\n.katex * {\n  -ms-high-contrast-adjust: none !important;\n}\n.katex * {\n  border-color: currentColor;\n}\n.katex .katex-version::after {\n  content: "0.16.9";\n}\n.katex .katex-mathml {\n  /* Accessibility hack to only show to screen readers\n         Found at: http://a11yproject.com/posts/how-to-hide-content/ */\n  position: absolute;\n  clip: rect(1px, 1px, 1px, 1px);\n  padding: 0;\n  border: 0;\n  height: 1px;\n  width: 1px;\n  overflow: hidden;\n}\n.katex .katex-html {\n  /* \newline is an empty block at top level, between .base elements */\n}\n.katex .katex-html > .newline {\n  display: block;\n}\n.katex .base {\n  position: relative;\n  display: inline-block;\n  white-space: nowrap;\n  width: -webkit-min-content;\n  width: -moz-min-content;\n  width: min-content;\n}\n.katex .strut {\n  display: inline-block;\n}\n.katex .textbf {\n  font-weight: bold;\n}\n.katex .textit {\n  font-style: italic;\n}\n.katex .textrm {\n  font-family: KaTeX_Main;\n}\n.katex .textsf {\n  font-family: KaTeX_SansSerif;\n}\n.katex .texttt {\n  font-family: KaTeX_Typewriter;\n}\n.katex .mathnormal {\n  font-family: KaTeX_Math;\n  font-style: italic;\n}\n.katex .mathit {\n  font-family: KaTeX_Main;\n  font-style: italic;\n}\n.katex .mathrm {\n  font-style: normal;\n}\n.katex .mathbf {\n  font-family: KaTeX_Main;\n  font-weight: bold;\n}\n.katex .boldsymbol {\n  font-family: KaTeX_Math;\n  font-weight: bold;\n  font-style: italic;\n}\n.katex .amsrm {\n  font-family: KaTeX_AMS;\n}\n.katex .mathbb,\n.katex .textbb {\n  font-family: KaTeX_AMS;\n}\n.katex .mathcal {\n  font-family: KaTeX_Caligraphic;\n}\n.katex .mathfrak,\n.katex .textfrak {\n  font-family: KaTeX_Fraktur;\n}\n.katex .mathboldfrak,\n.katex .textboldfrak {\n  font-family: KaTeX_Fraktur;\n  font-weight: bold;\n}\n.katex .mathtt {\n  font-family: KaTeX_Typewriter;\n}\n.katex .mathscr,\n.katex .textscr {\n  font-family: KaTeX_Script;\n}\n.katex .mathsf,\n.katex .textsf {\n  font-family: KaTeX_SansSerif;\n}\n.katex .mathboldsf,\n.katex .textboldsf {\n  font-family: KaTeX_SansSerif;\n  font-weight: bold;\n}\n.katex .mathitsf,\n.katex .textitsf {\n  font-family: KaTeX_SansSerif;\n  font-style: italic;\n}\n.katex .mainrm {\n  font-family: KaTeX_Main;\n  font-style: normal;\n}\n.katex .vlist-t {\n  display: inline-table;\n  table-layout: fixed;\n  border-collapse: collapse;\n}\n.katex .vlist-r {\n  display: table-row;\n}\n.katex .vlist {\n  display: table-cell;\n  vertical-align: bottom;\n  position: relative;\n}\n.katex .vlist > span {\n  display: block;\n  height: 0;\n  position: relative;\n}\n.katex .vlist > span > span {\n  display: inline-block;\n}\n.katex .vlist > span > .pstrut {\n  overflow: hidden;\n  width: 0;\n}\n.katex .vlist-t2 {\n  margin-right: -2px;\n}\n.katex .vlist-s {\n  display: table-cell;\n  vertical-align: bottom;\n  font-size: 1px;\n  width: 2px;\n  min-width: 2px;\n}\n.katex .vbox {\n  display: inline-flex;\n  flex-direction: column;\n  align-items: baseline;\n}\n.katex .hbox {\n  display: inline-flex;\n  flex-direction: row;\n  width: 100%;\n}\n.katex .thinbox {\n  display: inline-flex;\n  flex-direction: row;\n  width: 0;\n  max-width: 0;\n}\n.katex .msupsub {\n  text-align: left;\n}\n.katex .mfrac > span > span {\n  text-align: center;\n}\n.katex .mfrac .frac-line {\n  display: inline-block;\n  width: 100%;\n  border-bottom-style: solid;\n}\n.katex .mfrac .frac-line,\n.katex .overline .overline-line,\n.katex .underline .underline-line,\n.katex .hline,\n.katex .hdashline,\n.katex .rule {\n  min-height: 1px;\n}\n.katex .mspace {\n  display: inline-block;\n}\n.katex .llap,\n.katex .rlap,\n.katex .clap {\n  width: 0;\n  position: relative;\n}\n.katex .llap > .inner,\n.katex .rlap > .inner,\n.katex .clap > .inner {\n  position: absolute;\n}\n.katex .llap > .fix,\n.katex .rlap > .fix,\n.katex .clap > .fix {\n  display: inline-block;\n}\n.katex .llap > .inner {\n  right: 0;\n}\n.katex .rlap > .inner,\n.katex .clap > .inner {\n  left: 0;\n}\n.katex .clap > .inner > span {\n  margin-left: -50%;\n  margin-right: 50%;\n}\n.katex .rule {\n  display: inline-block;\n  border: solid 0;\n  position: relative;\n}\n.katex .overline .overline-line,\n.katex .underline .underline-line,\n.katex .hline {\n  display: inline-block;\n  width: 100%;\n  border-bottom-style: solid;\n}\n.katex .hdashline {\n  display: inline-block;\n  width: 100%;\n  border-bottom-style: dashed;\n}\n.katex .sqrt > .root {\n  margin-left: 0.27777778em;\n  margin-right: -0.55555556em;\n}\n.katex .sizing.reset-size1.size1,\n.katex .fontsize-ensurer.reset-size1.size1 {\n  font-size: 1em;\n}\n.katex .sizing.reset-size1.size2,\n.katex .fontsize-ensurer.reset-size1.size2 {\n  font-size: 1.2em;\n}\n.katex .sizing.reset-size1.size3,\n.katex .fontsize-ensurer.reset-size1.size3 {\n  font-size: 1.4em;\n}\n.katex .sizing.reset-size1.size4,\n.katex .fontsize-ensurer.reset-size1.size4 {\n  font-size: 1.6em;\n}\n.katex .sizing.reset-size1.size5,\n.katex .fontsize-ensurer.reset-size1.size5 {\n  font-size: 1.8em;\n}\n.katex .sizing.reset-size1.size6,\n.katex .fontsize-ensurer.reset-size1.size6 {\n  font-size: 2em;\n}\n.katex .sizing.reset-size1.size7,\n.katex .fontsize-ensurer.reset-size1.size7 {\n  font-size: 2.4em;\n}\n.katex .sizing.reset-size1.size8,\n.katex .fontsize-ensurer.reset-size1.size8 {\n  font-size: 2.88em;\n}\n.katex .sizing.reset-size1.size9,\n.katex .fontsize-ensurer.reset-size1.size9 {\n  font-size: 3.456em;\n}\n.katex .sizing.reset-size1.size10,\n.katex .fontsize-ensurer.reset-size1.size10 {\n  font-size: 4.148em;\n}\n.katex .sizing.reset-size1.size11,\n.katex .fontsize-ensurer.reset-size1.size11 {\n  font-size: 4.976em;\n}\n.katex .sizing.reset-size2.size1,\n.katex .fontsize-ensurer.reset-size2.size1 {\n  font-size: 0.83333333em;\n}\n.katex .sizing.reset-size2.size2,\n.katex .fontsize-ensurer.reset-size2.size2 {\n  font-size: 1em;\n}\n.katex .sizing.reset-size2.size3,\n.katex .fontsize-ensurer.reset-size2.size3 {\n  font-size: 1.16666667em;\n}\n.katex .sizing.reset-size2.size4,\n.katex .fontsize-ensurer.reset-size2.size4 {\n  font-size: 1.33333333em;\n}\n.katex .sizing.reset-size2.size5,\n.katex .fontsize-ensurer.reset-size2.size5 {\n  font-size: 1.5em;\n}\n.katex .sizing.reset-size2.size6,\n.katex .fontsize-ensurer.reset-size2.size6 {\n  font-size: 1.66666667em;\n}\n.katex .sizing.reset-size2.size7,\n.katex .fontsize-ensurer.reset-size2.size7 {\n  font-size: 2em;\n}\n.katex .sizing.reset-size2.size8,\n.katex .fontsize-ensurer.reset-size2.size8 {\n  font-size: 2.4em;\n}\n.katex .sizing.reset-size2.size9,\n.katex .fontsize-ensurer.reset-size2.size9 {\n  font-size: 2.88em;\n}\n.katex .sizing.reset-size2.size10,\n.katex .fontsize-ensurer.reset-size2.size10 {\n  font-size: 3.45666667em;\n}\n.katex .sizing.reset-size2.size11,\n.katex .fontsize-ensurer.reset-size2.size11 {\n  font-size: 4.14666667em;\n}\n.katex .sizing.reset-size3.size1,\n.katex .fontsize-ensurer.reset-size3.size1 {\n  font-size: 0.71428571em;\n}\n.katex .sizing.reset-size3.size2,\n.katex .fontsize-ensurer.reset-size3.size2 {\n  font-size: 0.85714286em;\n}\n.katex .sizing.reset-size3.size3,\n.katex .fontsize-ensurer.reset-size3.size3 {\n  font-size: 1em;\n}\n.katex .sizing.reset-size3.size4,\n.katex .fontsize-ensurer.reset-size3.size4 {\n  font-size: 1.14285714em;\n}\n.katex .sizing.reset-size3.size5,\n.katex .fontsize-ensurer.reset-size3.size5 {\n  font-size: 1.28571429em;\n}\n.katex .sizing.reset-size3.size6,\n.katex .fontsize-ensurer.reset-size3.size6 {\n  font-size: 1.42857143em;\n}\n.katex .sizing.reset-size3.size7,\n.katex .fontsize-ensurer.reset-size3.size7 {\n  font-size: 1.71428571em;\n}\n.katex .sizing.reset-size3.size8,\n.katex .fontsize-ensurer.reset-size3.size8 {\n  font-size: 2.05714286em;\n}\n.katex .sizing.reset-size3.size9,\n.katex .fontsize-ensurer.reset-size3.size9 {\n  font-size: 2.46857143em;\n}\n.katex .sizing.reset-size3.size10,\n.katex .fontsize-ensurer.reset-size3.size10 {\n  font-size: 2.96285714em;\n}\n.katex .sizing.reset-size3.size11,\n.katex .fontsize-ensurer.reset-size3.size11 {\n  font-size: 3.55428571em;\n}\n.katex .sizing.reset-size4.size1,\n.katex .fontsize-ensurer.reset-size4.size1 {\n  font-size: 0.625em;\n}\n.katex .sizing.reset-size4.size2,\n.katex .fontsize-ensurer.reset-size4.size2 {\n  font-size: 0.75em;\n}\n.katex .sizing.reset-size4.size3,\n.katex .fontsize-ensurer.reset-size4.size3 {\n  font-size: 0.875em;\n}\n.katex .sizing.reset-size4.size4,\n.katex .fontsize-ensurer.reset-size4.size4 {\n  font-size: 1em;\n}\n.katex .sizing.reset-size4.size5,\n.katex .fontsize-ensurer.reset-size4.size5 {\n  font-size: 1.125em;\n}\n.katex .sizing.reset-size4.size6,\n.katex .fontsize-ensurer.reset-size4.size6 {\n  font-size: 1.25em;\n}\n.katex .sizing.reset-size4.size7,\n.katex .fontsize-ensurer.reset-size4.size7 {\n  font-size: 1.5em;\n}\n.katex .sizing.reset-size4.size8,\n.katex .fontsize-ensurer.reset-size4.size8 {\n  font-size: 1.8em;\n}\n.katex .sizing.reset-size4.size9,\n.katex .fontsize-ensurer.reset-size4.size9 {\n  font-size: 2.16em;\n}\n.katex .sizing.reset-size4.size10,\n.katex .fontsize-ensurer.reset-size4.size10 {\n  font-size: 2.5925em;\n}\n.katex .sizing.reset-size4.size11,\n.katex .fontsize-ensurer.reset-size4.size11 {\n  font-size: 3.11em;\n}\n.katex .sizing.reset-size5.size1,\n.katex .fontsize-ensurer.reset-size5.size1 {\n  font-size: 0.55555556em;\n}\n.katex .sizing.reset-size5.size2,\n.katex .fontsize-ensurer.reset-size5.size2 {\n  font-size: 0.66666667em;\n}\n.katex .sizing.reset-size5.size3,\n.katex .fontsize-ensurer.reset-size5.size3 {\n  font-size: 0.77777778em;\n}\n.katex .sizing.reset-size5.size4,\n.katex .fontsize-ensurer.reset-size5.size4 {\n  font-size: 0.88888889em;\n}\n.katex .sizing.reset-size5.size5,\n.katex .fontsize-ensurer.reset-size5.size5 {\n  font-size: 1em;\n}\n.katex .sizing.reset-size5.size6,\n.katex .fontsize-ensurer.reset-size5.size6 {\n  font-size: 1.11111111em;\n}\n.katex .sizing.reset-size5.size7,\n.katex .fontsize-ensurer.reset-size5.size7 {\n  font-size: 1.33333333em;\n}\n.katex .sizing.reset-size5.size8,\n.katex .fontsize-ensurer.reset-size5.size8 {\n  font-size: 1.6em;\n}\n.katex .sizing.reset-size5.size9,\n.katex .fontsize-ensurer.reset-size5.size9 {\n  font-size: 1.92em;\n}\n.katex .sizing.reset-size5.size10,\n.katex .fontsize-ensurer.reset-size5.size10 {\n  font-size: 2.30444444em;\n}\n.katex .sizing.reset-size5.size11,\n.katex .fontsize-ensurer.reset-size5.size11 {\n  font-size: 2.76444444em;\n}\n.katex .sizing.reset-size6.size1,\n.katex .fontsize-ensurer.reset-size6.size1 {\n  font-size: 0.5em;\n}\n.katex .sizing.reset-size6.size2,\n.katex .fontsize-ensurer.reset-size6.size2 {\n  font-size: 0.6em;\n}\n.katex .sizing.reset-size6.size3,\n.katex .fontsize-ensurer.reset-size6.size3 {\n  font-size: 0.7em;\n}\n.katex .sizing.reset-size6.size4,\n.katex .fontsize-ensurer.reset-size6.size4 {\n  font-size: 0.8em;\n}\n.katex .sizing.reset-size6.size5,\n.katex .fontsize-ensurer.reset-size6.size5 {\n  font-size: 0.9em;\n}\n.katex .sizing.reset-size6.size6,\n.katex .fontsize-ensurer.reset-size6.size6 {\n  font-size: 1em;\n}\n.katex .sizing.reset-size6.size7,\n.katex .fontsize-ensurer.reset-size6.size7 {\n  font-size: 1.2em;\n}\n.katex .sizing.reset-size6.size8,\n.katex .fontsize-ensurer.reset-size6.size8 {\n  font-size: 1.44em;\n}\n.katex .sizing.reset-size6.size9,\n.katex .fontsize-ensurer.reset-size6.size9 {\n  font-size: 1.728em;\n}\n.katex .sizing.reset-size6.size10,\n.katex .fontsize-ensurer.reset-size6.size10 {\n  font-size: 2.074em;\n}\n.katex .sizing.reset-size6.size11,\n.katex .fontsize-ensurer.reset-size6.size11 {\n  font-size: 2.488em;\n}\n.katex .sizing.reset-size7.size1,\n.katex .fontsize-ensurer.reset-size7.size1 {\n  font-size: 0.41666667em;\n}\n.katex .sizing.reset-size7.size2,\n.katex .fontsize-ensurer.reset-size7.size2 {\n  font-size: 0.5em;\n}\n.katex .sizing.reset-size7.size3,\n.katex .fontsize-ensurer.reset-size7.size3 {\n  font-size: 0.58333333em;\n}\n.katex .sizing.reset-size7.size4,\n.katex .fontsize-ensurer.reset-size7.size4 {\n  font-size: 0.66666667em;\n}\n.katex .sizing.reset-size7.size5,\n.katex .fontsize-ensurer.reset-size7.size5 {\n  font-size: 0.75em;\n}\n.katex .sizing.reset-size7.size6,\n.katex .fontsize-ensurer.reset-size7.size6 {\n  font-size: 0.83333333em;\n}\n.katex .sizing.reset-size7.size7,\n.katex .fontsize-ensurer.reset-size7.size7 {\n  font-size: 1em;\n}\n.katex .sizing.reset-size7.size8,\n.katex .fontsize-ensurer.reset-size7.size8 {\n  font-size: 1.2em;\n}\n.katex .sizing.reset-size7.size9,\n.katex .fontsize-ensurer.reset-size7.size9 {\n  font-size: 1.44em;\n}\n.katex .sizing.reset-size7.size10,\n.katex .fontsize-ensurer.reset-size7.size10 {\n  font-size: 1.72833333em;\n}\n.katex .sizing.reset-size7.size11,\n.katex .fontsize-ensurer.reset-size7.size11 {\n  font-size: 2.07333333em;\n}\n.katex .sizing.reset-size8.size1,\n.katex .fontsize-ensurer.reset-size8.size1 {\n  font-size: 0.34722222em;\n}\n.katex .sizing.reset-size8.size2,\n.katex .fontsize-ensurer.reset-size8.size2 {\n  font-size: 0.41666667em;\n}\n.katex .sizing.reset-size8.size3,\n.katex .fontsize-ensurer.reset-size8.size3 {\n  font-size: 0.48611111em;\n}\n.katex .sizing.reset-size8.size4,\n.katex .fontsize-ensurer.reset-size8.size4 {\n  font-size: 0.55555556em;\n}\n.katex .sizing.reset-size8.size5,\n.katex .fontsize-ensurer.reset-size8.size5 {\n  font-size: 0.625em;\n}\n.katex .sizing.reset-size8.size6,\n.katex .fontsize-ensurer.reset-size8.size6 {\n  font-size: 0.69444444em;\n}\n.katex .sizing.reset-size8.size7,\n.katex .fontsize-ensurer.reset-size8.size7 {\n  font-size: 0.83333333em;\n}\n.katex .sizing.reset-size8.size8,\n.katex .fontsize-ensurer.reset-size8.size8 {\n  font-size: 1em;\n}\n.katex .sizing.reset-size8.size9,\n.katex .fontsize-ensurer.reset-size8.size9 {\n  font-size: 1.2em;\n}\n.katex .sizing.reset-size8.size10,\n.katex .fontsize-ensurer.reset-size8.size10 {\n  font-size: 1.44027778em;\n}\n.katex .sizing.reset-size8.size11,\n.katex .fontsize-ensurer.reset-size8.size11 {\n  font-size: 1.72777778em;\n}\n.katex .sizing.reset-size9.size1,\n.katex .fontsize-ensurer.reset-size9.size1 {\n  font-size: 0.28935185em;\n}\n.katex .sizing.reset-size9.size2,\n.katex .fontsize-ensurer.reset-size9.size2 {\n  font-size: 0.34722222em;\n}\n.katex .sizing.reset-size9.size3,\n.katex .fontsize-ensurer.reset-size9.size3 {\n  font-size: 0.40509259em;\n}\n.katex .sizing.reset-size9.size4,\n.katex .fontsize-ensurer.reset-size9.size4 {\n  font-size: 0.46296296em;\n}\n.katex .sizing.reset-size9.size5,\n.katex .fontsize-ensurer.reset-size9.size5 {\n  font-size: 0.52083333em;\n}\n.katex .sizing.reset-size9.size6,\n.katex .fontsize-ensurer.reset-size9.size6 {\n  font-size: 0.5787037em;\n}\n.katex .sizing.reset-size9.size7,\n.katex .fontsize-ensurer.reset-size9.size7 {\n  font-size: 0.69444444em;\n}\n.katex .sizing.reset-size9.size8,\n.katex .fontsize-ensurer.reset-size9.size8 {\n  font-size: 0.83333333em;\n}\n.katex .sizing.reset-size9.size9,\n.katex .fontsize-ensurer.reset-size9.size9 {\n  font-size: 1em;\n}\n.katex .sizing.reset-size9.size10,\n.katex .fontsize-ensurer.reset-size9.size10 {\n  font-size: 1.20023148em;\n}\n.katex .sizing.reset-size9.size11,\n.katex .fontsize-ensurer.reset-size9.size11 {\n  font-size: 1.43981481em;\n}\n.katex .sizing.reset-size10.size1,\n.katex .fontsize-ensurer.reset-size10.size1 {\n  font-size: 0.24108004em;\n}\n.katex .sizing.reset-size10.size2,\n.katex .fontsize-ensurer.reset-size10.size2 {\n  font-size: 0.28929605em;\n}\n.katex .sizing.reset-size10.size3,\n.katex .fontsize-ensurer.reset-size10.size3 {\n  font-size: 0.33751205em;\n}\n.katex .sizing.reset-size10.size4,\n.katex .fontsize-ensurer.reset-size10.size4 {\n  font-size: 0.38572806em;\n}\n.katex .sizing.reset-size10.size5,\n.katex .fontsize-ensurer.reset-size10.size5 {\n  font-size: 0.43394407em;\n}\n.katex .sizing.reset-size10.size6,\n.katex .fontsize-ensurer.reset-size10.size6 {\n  font-size: 0.48216008em;\n}\n.katex .sizing.reset-size10.size7,\n.katex .fontsize-ensurer.reset-size10.size7 {\n  font-size: 0.57859209em;\n}\n.katex .sizing.reset-size10.size8,\n.katex .fontsize-ensurer.reset-size10.size8 {\n  font-size: 0.69431051em;\n}\n.katex .sizing.reset-size10.size9,\n.katex .fontsize-ensurer.reset-size10.size9 {\n  font-size: 0.83317261em;\n}\n.katex .sizing.reset-size10.size10,\n.katex .fontsize-ensurer.reset-size10.size10 {\n  font-size: 1em;\n}\n.katex .sizing.reset-size10.size11,\n.katex .fontsize-ensurer.reset-size10.size11 {\n  font-size: 1.19961427em;\n}\n.katex .sizing.reset-size11.size1,\n.katex .fontsize-ensurer.reset-size11.size1 {\n  font-size: 0.20096463em;\n}\n.katex .sizing.reset-size11.size2,\n.katex .fontsize-ensurer.reset-size11.size2 {\n  font-size: 0.24115756em;\n}\n.katex .sizing.reset-size11.size3,\n.katex .fontsize-ensurer.reset-size11.size3 {\n  font-size: 0.28135048em;\n}\n.katex .sizing.reset-size11.size4,\n.katex .fontsize-ensurer.reset-size11.size4 {\n  font-size: 0.32154341em;\n}\n.katex .sizing.reset-size11.size5,\n.katex .fontsize-ensurer.reset-size11.size5 {\n  font-size: 0.36173633em;\n}\n.katex .sizing.reset-size11.size6,\n.katex .fontsize-ensurer.reset-size11.size6 {\n  font-size: 0.40192926em;\n}\n.katex .sizing.reset-size11.size7,\n.katex .fontsize-ensurer.reset-size11.size7 {\n  font-size: 0.48231511em;\n}\n.katex .sizing.reset-size11.size8,\n.katex .fontsize-ensurer.reset-size11.size8 {\n  font-size: 0.57877814em;\n}\n.katex .sizing.reset-size11.size9,\n.katex .fontsize-ensurer.reset-size11.size9 {\n  font-size: 0.69453376em;\n}\n.katex .sizing.reset-size11.size10,\n.katex .fontsize-ensurer.reset-size11.size10 {\n  font-size: 0.83360129em;\n}\n.katex .sizing.reset-size11.size11,\n.katex .fontsize-ensurer.reset-size11.size11 {\n  font-size: 1em;\n}\n.katex .delimsizing.size1 {\n  font-family: KaTeX_Size1;\n}\n.katex .delimsizing.size2 {\n  font-family: KaTeX_Size2;\n}\n.katex .delimsizing.size3 {\n  font-family: KaTeX_Size3;\n}\n.katex .delimsizing.size4 {\n  font-family: KaTeX_Size4;\n}\n.katex .delimsizing.mult .delim-size1 > span {\n  font-family: KaTeX_Size1;\n}\n.katex .delimsizing.mult .delim-size4 > span {\n  font-family: KaTeX_Size4;\n}\n.katex .nulldelimiter {\n  display: inline-block;\n  width: 0.12em;\n}\n.katex .delimcenter {\n  position: relative;\n}\n.katex .op-symbol {\n  position: relative;\n}\n.katex .op-symbol.small-op {\n  font-family: KaTeX_Size1;\n}\n.katex .op-symbol.large-op {\n  font-family: KaTeX_Size2;\n}\n.katex .op-limits > .vlist-t {\n  text-align: center;\n}\n.katex .accent > .vlist-t {\n  text-align: center;\n}\n.katex .accent .accent-body {\n  position: relative;\n}\n.katex .accent .accent-body:not(.accent-full) {\n  width: 0;\n}\n.katex .overlay {\n  display: block;\n}\n.katex .mtable .vertical-separator {\n  display: inline-block;\n  min-width: 1px;\n}\n.katex .mtable .arraycolsep {\n  display: inline-block;\n}\n.katex .mtable .col-align-c > .vlist-t {\n  text-align: center;\n}\n.katex .mtable .col-align-l > .vlist-t {\n  text-align: left;\n}\n.katex .mtable .col-align-r > .vlist-t {\n  text-align: right;\n}\n.katex .svg-align {\n  text-align: left;\n}\n.katex svg {\n  display: block;\n  position: absolute;\n  width: 100%;\n  height: inherit;\n  fill: currentColor;\n  stroke: currentColor;\n  fill-rule: nonzero;\n  fill-opacity: 1;\n  stroke-width: 1;\n  stroke-linecap: butt;\n  stroke-linejoin: miter;\n  stroke-miterlimit: 4;\n  stroke-dasharray: none;\n  stroke-dashoffset: 0;\n  stroke-opacity: 1;\n}\n.katex svg path {\n  stroke: none;\n}\n.katex img {\n  border-style: none;\n  min-width: 0;\n  min-height: 0;\n  max-width: none;\n  max-height: none;\n}\n.katex .stretchy {\n  width: 100%;\n  display: block;\n  position: relative;\n  overflow: hidden;\n}\n.katex .stretchy::before,\n.katex .stretchy::after {\n  content: "";\n}\n.katex .hide-tail {\n  width: 100%;\n  position: relative;\n  overflow: hidden;\n}\n.katex .halfarrow-left {\n  position: absolute;\n  left: 0;\n  width: 50.2%;\n  overflow: hidden;\n}\n.katex .halfarrow-right {\n  position: absolute;\n  right: 0;\n  width: 50.2%;\n  overflow: hidden;\n}\n.katex .brace-left {\n  position: absolute;\n  left: 0;\n  width: 25.1%;\n  overflow: hidden;\n}\n.katex .brace-center {\n  position: absolute;\n  left: 25%;\n  width: 50%;\n  overflow: hidden;\n}\n.katex .brace-right {\n  position: absolute;\n  right: 0;\n  width: 25.1%;\n  overflow: hidden;\n}\n.katex .x-arrow-pad {\n  padding: 0 0.5em;\n}\n.katex .cd-arrow-pad {\n  padding: 0 0.55556em 0 0.27778em;\n}\n.katex .x-arrow,\n.katex .mover,\n.katex .munder {\n  text-align: center;\n}\n.katex .boxpad {\n  padding: 0 0.3em;\n}\n.katex .fbox,\n.katex .fcolorbox {\n  box-sizing: border-box;\n  border: 0.04em solid;\n}\n.katex .cancel-pad {\n  padding: 0 0.2em;\n}\n.katex .cancel-lap {\n  margin-left: -0.2em;\n  margin-right: -0.2em;\n}\n.katex .sout {\n  border-bottom-style: solid;\n  border-bottom-width: 0.08em;\n}\n.katex .angl {\n  box-sizing: border-box;\n  border-top: 0.049em solid;\n  border-right: 0.049em solid;\n  margin-right: 0.03889em;\n}\n.katex .anglpad {\n  padding: 0 0.03889em;\n}\n.katex .eqn-num::before {\n  counter-increment: katexEqnNo;\n  content: "(" counter(katexEqnNo) ")";\n}\n.katex .mml-eqn-num::before {\n  counter-increment: mmlEqnNo;\n  content: "(" counter(mmlEqnNo) ")";\n}\n.katex .mtr-glue {\n  width: 50%;\n}\n.katex .cd-vert-arrow {\n  display: inline-block;\n  position: relative;\n}\n.katex .cd-label-left {\n  display: inline-block;\n  position: absolute;\n  right: calc(50% + 0.3em);\n  text-align: left;\n}\n.katex .cd-label-right {\n  display: inline-block;\n  position: absolute;\n  left: calc(50% + 0.3em);\n  text-align: right;\n}\n.katex-display {\n  display: block;\n  margin: 1em 0;\n  text-align: center;\n}\n.katex-display > .katex {\n  display: block;\n  text-align: center;\n  white-space: nowrap;\n}\n.katex-display > .katex > .katex-html {\n  display: block;\n  position: relative;\n}\n.katex-display > .katex > .katex-html > .tag {\n  position: absolute;\n  right: 0;\n}\n.katex-display.leqno > .katex > .katex-html > .tag {\n  left: 0;\n  right: auto;\n}\n.katex-display.fleqn > .katex {\n  text-align: left;\n  padding-left: 2em;\n}\nbody {\n  counter-reset: katexEqnNo mmlEqnNo;\n}\n';let d=!1;const l=o["a"].import("formats/formula");class c{constructor(e){this.opt=e,this.mindMap=e.mindMap,window.katex=s.a,this.init(),this.config=this.getKatexConfig(),this.cssEl=null,this.addStyle(),this.extendQuill(),this.onDestroy=this.onDestroy.bind(this),this.mindMap.on("beforeDestroy",this.onDestroy)}onDestroy(){const e=Object.getPrototypeOf(this.mindMap).constructor.instanceCount;e<=1&&(d=!1,o["a"].register("formats/formula",l,!0))}init(){this.mindMap.opt.enableEditFormulaInRichTextEdit&&(this.mindMap.opt.transformRichTextOnEnterEdit=this.latexRichToText.bind(this),this.mindMap.opt.beforeHideRichTextEdit=this.formatLatex.bind(this))}getKatexConfig(){const e={throwOnError:!1,errorColor:"#f00",output:"mathml"};let{getKatexOutputType:t}=this.mindMap.opt;t=t||function(){const e=Object(a["D"])();if(e&&e<=100)return"html"};const i=t()||"mathml";return e.output=["mathml","html"].includes(i)?i:"mathml",e}extendQuill(){if(d)return;d=!0;const e=this;class t extends l{static create(t){let i=super.create(t);return"string"===typeof t&&(s.a.render(t,i,e.config),i.setAttribute("data-value",Object(a["V"])(t))),i}}o["a"].register("formats/formula",t,!0)}getStyleText(){const{katexFontPath:e}=this.mindMap.opt;let t="";return"html"===this.config.output&&(t=r(e)),t+=h(),t}addStyle(){this.cssEl=document.createElement("style"),this.cssEl.type="text/css",this.cssEl.innerHTML=this.getStyleText(),document.head.appendChild(this.cssEl)}removeStyle(){document.head.removeChild(this.cssEl)}insertFormulaToNode(e,t){const i=this.mindMap.richText;i.showEditText({node:e}),i.quill.insertEmbed(i.quill.getLength()-1,"formula",t),i.hideEditText([e])}latexRichToText(e){if(-1!==e.indexOf('class="ql-formula"')){const t=new DOMParser,i=t.parseFromString(e,"text/html"),n=i.getElementsByClassName("ql-formula");for(const s of n)e=e.replace(s.outerHTML,`$${s.getAttribute("data-value")}$`);this.mindMap.opt.openRealtimeRenderOnNodeTextEdit&&setTimeout(()=>{this.mindMap.emit("node_text_edit_change",{node:this.mindMap.richText.node,text:this.mindMap.richText.getEditText(),richText:!0})},0)}return e}formatLatex(e){const t=e.quill.getContents(),i=t.ops;let n=!1;for(let s=i.length-1;s>=0;s--){const e=i[s],t=e.insert;if(t&&"object"!==typeof t&&"\n"!==t&&/\$.+?\$/g.test(t)){const e=[...t.matchAll(/\$.+?\$/g)],o=t.split(/\$.+?\$/g);for(let t=e.length-1;t>=0;t--){const i=e[t]&&e[t][0]&&e[t][0].slice(1,-1)||null;if(null!==i&&i.trim().length>0){const e=this.checkFormulaIsLegal(i);e?(o.splice(t+1,0,{insert:{formula:i}}),n=!0):o.splice(t+1,0,"")}else o.splice(t+1,0,"")}while(o.length>0){let e=o.pop();if("string"===typeof e){if(e.length<1)continue;e={insert:e}}e["attributes"]=i[s]["attributes"],i.splice(s+1,0,e)}i.splice(s,1)}}n&&e.quill.setContents(t)}checkFormulaIsLegal(e){try{return s.a.renderToString(e),!0}catch(t){return!1}}beforePluginRemove(){this.removeStyle(),this.mindMap.off("beforeDestroy",this.onDestroy)}beforePluginDestroy(){this.removeStyle(),this.mindMap.off("beforeDestroy",this.onDestroy)}}c.instanceName="formula";t["a"]=c},aab3:function(e,t,i){"use strict";var n=i("d17d"),s=i("82df");class o{constructor({mindMap:e}){this.mindMap=e,this.handleEl=null,this.isShowHandleEl=!1,this.node=null,this.img=null,this.rect=null,this.isMousedown=!1,this.mousedownDrawTransform=null,this.mousedownOffset={x:0,y:0},this.currentImgWidth=0,this.currentImgHeight=0,this.isAdjusted=!1,this.bindEvent()}bindEvent(){this.onNodeImgMouseleave=this.onNodeImgMouseleave.bind(this),this.onNodeImgMousemove=this.onNodeImgMousemove.bind(this),this.onMousemove=this.onMousemove.bind(this),this.onMouseup=this.onMouseup.bind(this),this.onRenderEnd=this.onRenderEnd.bind(this),this.onScale=this.onScale.bind(this),this.mindMap.on("node_img_mouseleave",this.onNodeImgMouseleave),this.mindMap.on("node_img_mousemove",this.onNodeImgMousemove),this.mindMap.on("mousemove",this.onMousemove),this.mindMap.on("mouseup",this.onMouseup),this.mindMap.on("node_mouseup",this.onMouseup),this.mindMap.on("node_tree_render_end",this.onRenderEnd),this.mindMap.on("scale",this.onScale)}unBindEvent(){this.mindMap.off("node_img_mouseleave",this.onNodeImgMouseleave),this.mindMap.off("node_img_mousemove",this.onNodeImgMousemove),this.mindMap.off("mousemove",this.onMousemove),this.mindMap.off("mouseup",this.onMouseup),this.mindMap.off("node_mouseup",this.onMouseup),this.mindMap.off("node_tree_render_end",this.onRenderEnd),this.mindMap.off("scale",this.onScale)}onScale(){this.node&&this.img&&this.isShowHandleEl&&(this.rect=this.img.rbox(),this.setHandleElRect())}onNodeImgMousemove(e,t){this.isMousedown||this.isAdjusted||this.mindMap.opt.readonly||this.node&&this.node.uid===e.uid&&this.isShowHandleEl||(this.node=e,this.img=t,this.rect=this.img.rbox(),this.showHandleEl())}onNodeImgMouseleave(){this.isMousedown||this.hideHandleEl()}hideNodeImage(){this.img&&this.img.hide()}showNodeImage(){this.img&&this.img.show()}showHandleEl(){this.isShowHandleEl||(this.handleEl||this.createResizeBtnEl(),this.setHandleElRect(),this.handleEl.style.display="block",this.isShowHandleEl=!0)}hideHandleEl(){this.isShowHandleEl&&(this.isShowHandleEl=!1,this.handleEl.style.display="none",this.handleEl.style.backgroundImage="",this.handleEl.style.width=0,this.handleEl.style.height=0,this.handleEl.style.left=0,this.handleEl.style.top=0)}setHandleElRect(){let{width:e,height:t,x:i,y:n}=this.rect;this.handleEl.style.left=i+"px",this.handleEl.style.top=n+"px",this.currentImgWidth=e,this.currentImgHeight=t,this.updateHandleElSize()}updateHandleElSize(){this.handleEl.style.width=this.currentImgWidth+"px",this.handleEl.style.height=this.currentImgHeight+"px"}createResizeBtnEl(){const{imgResizeBtnSize:e,customResizeBtnInnerHTML:t,customDeleteBtnInnerHTML:i}=this.mindMap.opt;this.handleEl=document.createElement("div"),this.handleEl.style.cssText="\n      pointer-events: none;\n      position: fixed;\n\t    display:none;\n      background-size: cover;\n    ",this.handleEl.className="node-img-handle";const n=document.createElement("div");n.innerHTML=t||s["a"].imgAdjust,n.style.cssText=`\n      position: absolute;\n      right: 0;\n      bottom: 0;\n      pointer-events: auto;\n      background-color: rgba(0, 0, 0, 0.3);\n      width: ${e}px;\n      height: ${e}px;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      cursor: nwse-resize;\n    `,n.className="node-image-resize",n.addEventListener("mouseenter",()=>{this.showHandleEl()}),n.addEventListener("mouseleave",()=>{this.isMousedown||this.hideHandleEl()}),n.addEventListener("mousedown",e=>{e.stopPropagation(),e.preventDefault(),this.onMousedown(e)}),n.addEventListener("mouseup",e=>{setTimeout(()=>{this.hideHandleEl(),this.isAdjusted=!1},0)}),n.addEventListener("click",e=>{e.stopPropagation()}),this.handleEl.appendChild(n);const o=document.createElement("div");this.handleEl.prepend(o),o.className="node-image-remove",o.innerHTML=i||s["a"].remove,o.style.cssText=`\n      position: absolute;\n      right: 0;top:0;color:#fff;\n      pointer-events: auto;\n      background-color: rgba(0, 0, 0, 0.3);\n      width: ${e}px;\n      height: ${e}px;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      cursor: pointer;\n    `,o.addEventListener("mouseenter",e=>{this.showHandleEl()}),o.addEventListener("mouseleave",e=>{this.isMousedown||this.hideHandleEl()}),o.addEventListener("click",async e=>{let t=!1;"function"===typeof this.mindMap.opt.beforeDeleteNodeImg&&(t=await this.mindMap.opt.beforeDeleteNodeImg(this.node)),t||(this.mindMap.execCommand("SET_NODE_IMAGE",this.node,{url:null}),this.mindMap.emit("delete_node_img_from_delete_btn",this.node))});const a=this.mindMap.opt.customInnerElsAppendTo||document.body;a.appendChild(this.handleEl)}onMousedown(e){this.mindMap.emit("node_img_adjust_btn_mousedown",this.node),this.isMousedown=!0,this.mousedownDrawTransform=this.mindMap.draw.transform(),this.hideNodeImage(),this.mousedownOffset.x=e.clientX-this.rect.x2,this.mousedownOffset.y=e.clientY-this.rect.y2,this.handleEl.style.backgroundImage=`url(${this.node.getData("image")})`}onMousemove(e){if(!this.isMousedown)return;e.preventDefault();const{scaleX:t,scaleY:i}=this.mousedownDrawTransform,{width:s,height:o}=this.node.getData("imageSize");let{minImgResizeWidth:a,minImgResizeHeight:r,maxImgResizeWidthInheritTheme:h,maxImgResizeWidth:d,maxImgResizeHeight:l}=this.mindMap.opt;const c=a/r,m=s/o;let u,f;c>m?r=a/m:a=r*m,h?(u=this.mindMap.getThemeConfig("imgMaxWidth"),f=this.mindMap.getThemeConfig("imgMaxHeight")):(u=d,f=l),u*=t,f*=i;let p=Math.abs(e.clientX-this.rect.x-this.mousedownOffset.x),x=Math.abs(e.clientY-this.rect.y-this.mousedownOffset.y);p<a&&(p=a),x<r&&(x=r),p>u&&(p=u),x>f&&(x=f);const[g,z]=Object(n["qb"])(s,o,p,x);this.currentImgWidth=g,this.currentImgHeight=z,this.updateHandleElSize()}onMouseup(){if(!this.isMousedown)return;this.showNodeImage(),this.hideHandleEl();const{image:e,imageTitle:t}=this.node.getData(),{scaleX:i,scaleY:n}=this.mousedownDrawTransform,s=this.currentImgWidth/i,o=this.currentImgHeight/n;(Math.abs(s-this.rect.width)>1||Math.abs(o-this.rect.height)>1)&&(this.mindMap.execCommand("SET_NODE_IMAGE",this.node,{url:e,title:t,width:s,height:o,custom:!0}),this.isAdjusted=!0),this.isMousedown=!1,this.mousedownDrawTransform=null,this.mousedownOffset.x=0,this.mousedownOffset.y=0}onRenderEnd(){this.isAdjusted?this.isAdjusted=!1:this.hideHandleEl()}beforePluginRemove(){this.unBindEvent()}beforePluginDestroy(){this.unBindEvent()}}o.instanceName="nodeImgAdjust",t["a"]=o},d65a:function(e,t,i){"use strict";var n=i("d17d");class s{constructor(e){this.opt=e,this.mindMap=e.mindMap,this.bindEvent()}bindEvent(){this.onBeforeAddHistory=this.onBeforeAddHistory.bind(this),this.mindMap.on("beforeAddHistory",this.onBeforeAddHistory)}unBindEvent(){this.mindMap.off("beforeAddHistory",this.onBeforeAddHistory)}isBase64ImgUrl(e){return/^data:/.test(e)}isImageKey(e){return/^smm_img_key_/.test(e)}createImageKey(){return"smm_img_key_"+Object(n["r"])()}onBeforeAddHistory(){const e=this.mindMap.renderer.renderTree;if(!e)return;let t=e.data.imgMap;t||(t=e.data.imgMap={});const i=[],s=()=>Object.keys(t),o=e=>s().find(i=>t[i]===e);Object(n["yb"])(e,null,e=>{const n=e.data.image;if(n)if(this.isBase64ImgUrl(n)){const s=o(n);if(s)i.push(s),e.data.image=s;else{const s=this.createImageKey();e.data.image=s,t[s]=n,i.push(s)}}else this.isImageKey(n)&&s().includes(n)&&i.push(n)}),s().forEach(e=>{i.includes(e)||delete t[e]})}beforePluginRemove(){this.unBindEvent()}beforePluginDestroy(){this.unBindEvent()}}s.instanceName="nodeBase64ImageStorage",t["a"]=s},ec02:function(e,t,i){"use strict";var n=i("d17d");class s{constructor(e){this.mindMap=e.mindMap,this.isMousedown=!1,this.mousedownPos={x:0,y:0},this.startViewPos={x:0,y:0},this.currentState=null}calculationMiniMap(e,t){let{svg:i,rect:n,origWidth:s,origHeight:o,scaleX:a,scaleY:r}=this.mindMap.getSvgData({ignoreWatermark:!0});const h=this.mindMap.elRect;n.x-=h.left,n.x2-=h.left,n.y-=h.top,n.y2-=h.top;let d=e/t,l=0,c=0;d>n.ratio?(c=t,l=n.ratio*c):(l=e,c=l/n.ratio);let m=l/n.width,u=(e-l)/2,f=(t-c)/2,p=n.width*a,x=n.height*r,g=(p-n.width)/2,z=(x-n.height)/2,y=n.x-g,k=n.x2+g,w=n.y-z,M=n.y2+z,b={left:0,top:0,right:0,bottom:0};b.left=Math.max(0,-y/p*l)+u,b.right=Math.max(0,(k-s)/p*l)+u,b.top=Math.max(0,-w/x*c)+f,b.bottom=Math.max(0,(M-o)/x*c)+f,b.top>f+c&&(b.top=f+c),b.left>u+l&&(b.left=u+l),Object.keys(b).forEach(e=>{b[e]=b[e]+"px"}),this.removeNodeContent(i);const E=i.svg();return this.currentState={viewBoxStyle:{...b},miniMapBoxScale:m,miniMapBoxLeft:u,miniMapBoxTop:f},{getImgUrl:async e=>{const t=await this.mindMap.doExport.fixSvgStrAndToBlob(E);e(t)},svgHTML:E,viewBoxStyle:b,miniMapBoxScale:m,miniMapBoxLeft:u,miniMapBoxTop:f}}removeNodeContent(e){if(e.hasClass("smm-node")){let t=e.findOne(".smm-node-shape"),i=t.attr("fill");return(Object(n["cb"])(i)||Object(n["ab"])(i))&&t.attr("fill",Object(n["R"])(this.mindMap.themeConfig)),e.clear(),void e.add(t)}let t=e.children();t&&t.length>0&&t.forEach(e=>{this.removeNodeContent(e)})}onMousedown(e){this.isMousedown=!0,this.mousedownPos={x:e.clientX,y:e.clientY};let t=this.mindMap.view.getTransformData();this.startViewPos={x:t.state.x,y:t.state.y}}onMousemove(e,t=5){if(!this.isMousedown||this.isViewBoxMousedown)return;let i=e.clientX-this.mousedownPos.x,n=e.clientY-this.mousedownPos.y;this.mindMap.view.translateXTo(i*t+this.startViewPos.x),this.mindMap.view.translateYTo(n*t+this.startViewPos.y)}onMouseup(){this.isMousedown=!1,this.isViewBoxMousedown=!1}onViewBoxMousedown(e){this.isViewBoxMousedown=!0,this.mousedownPos={x:e.clientX,y:e.clientY};let t=this.mindMap.view.getTransformData();this.startViewPos={x:t.state.x,y:t.state.y}}onViewBoxMousemove(e){if(!this.isViewBoxMousedown||!this.currentState||this.isMousedown)return;let t=e.clientX-this.mousedownPos.x,i=e.clientY-this.mousedownPos.y;const{viewBoxStyle:n,miniMapBoxScale:s,miniMapBoxLeft:o,miniMapBoxTop:a}=this.currentState,r=Math.max(o,Number.parseFloat(n.left)+t),h=Math.max(o,Number.parseFloat(n.right)-t),d=Math.max(a,Number.parseFloat(n.top)+i),l=Math.max(a,Number.parseFloat(n.bottom)-i);this.mindMap.emit("mini_map_view_box_position_change",{left:r+"px",right:h+"px",top:d+"px",bottom:l+"px"}),this.mindMap.view.translateXTo(-t/s+this.startViewPos.x),this.mindMap.view.translateYTo(-i/s+this.startViewPos.y)}}s.instanceName="miniMap",t["a"]=s},f503:function(e,t,i){"use strict";var n=i("d17d");const s=e=>{e=Object(n["P"])(e);const t={},i={};e.forEach(e=>{const n=e.parent;if(n){const s=n.uid;i[s]=n;const o=e.getIndexInBrothers(),a={node:e,index:o};t[s]?t[s].find(e=>e.index===a.index)||t[s].push(a):t[s]=[a]}});const s=[];return Object.keys(t).forEach(e=>{const n=t[e],o=i[e];if(n.length>1){const e=n.map(e=>e.index).sort((e,t)=>e-t),t=e[0],i=e[e.length-1];let a=-1,r=-1;for(let n=t;n<=i;n++)e.includes(n)?(-1===a&&(a=n),r=n):(-1!==a&&-1!==r&&s.push({node:o,range:[a,r]}),a=-1,r=-1);-1!==a&&-1!==r&&s.push({node:o,range:[a,r]})}else s.push({node:o,range:[n[0].index,n[0].index]})}),s},o=e=>{const t=e.children;if(!t||t.length<=0)return;const i=[],n={};return t.forEach((e,t)=>{const s=e.getData("outerFrame");if(!s)return;const o=s.groupId;o?(n[o]||(n[o]=[]),n[o].push({node:e,index:t})):i.push({nodeList:[e],range:[t,t]})}),Object.keys(n).forEach(e=>{const t=n[e];i.push({nodeList:t.map(e=>e.node),range:[t[0].index,t[t.length-1].index]})}),i};var a=i("6682");const r="outer-frame-text-edit-warp";function h(e,t,i){const n=this.draw.group(),s=()=>{this.activeOuterFrame&&this.activeOuterFrame.el===e||this.setActiveOuterFrame(e,t,i,n)};return n.click(e=>{e.stopPropagation(),s()}),n.on("dblclick",e=>{e.stopPropagation(),s(),this.showEditTextBox(n)}),n}function d(e){if(this.mindMap.emit("before_show_text_edit"),this.mindMap.keyCommand.addShortcut("Enter",()=>{this.hideEditTextBox()}),!this.textEditNode){this.textEditNode=document.createElement("div"),this.textEditNode.className=r,this.textEditNode.style.cssText="\n      position: fixed;\n      box-sizing: border-box;\n      background-color: #fff;\n      box-shadow: 0 0 20px rgba(0,0,0,.5);\n      outline: none; \n      word-break: break-all;\n    ",this.textEditNode.setAttribute("contenteditable",!0),this.textEditNode.addEventListener("keyup",e=>{e.stopPropagation()}),this.textEditNode.addEventListener("click",e=>{e.stopPropagation()});const e=this.mindMap.opt.customInnerElsAppendTo||document.body;e.appendChild(this.textEditNode)}const{node:t,range:i}=this.activeOuterFrame,s=this.getStyle(this.getNodeRangeFirstNode(t,i)),[o,a,h,d]=s.textFillPadding;let{defaultOuterFrameText:l,nodeTextEditZIndex:c}=this.mindMap.opt,m=this.mindMap.view.scale,u=this.getText(this.getNodeRangeFirstNode(t,i)),f=(u||l).split(/\n/gim);this.textEditNode.style.padding=`${o}px ${a}px ${h}px ${d}px`,this.textEditNode.style.fontFamily=s.fontFamily,this.textEditNode.style.fontSize=s.fontSize*m+"px",this.textEditNode.style.fontWeight=s.fontWeight,this.textEditNode.style.fontStyle=s.fontStyle,this.textEditNode.style.lineHeight=f.length>1?s.lineHeight:"normal",this.textEditNode.style.zIndex=c,this.textEditNode.innerHTML=f.join("<br>"),this.textEditNode.style.display="block",this.updateTextEditBoxPos(e),this.setIsShowTextEdit(!0),""===u||u===l?Object(n["rb"])(this.textEditNode):Object(n["x"])(this.textEditNode)}function l(e){this.showTextEdit=e,e?this.mindMap.keyCommand.stopCheckInSvg():this.mindMap.keyCommand.recoveryCheckInSvg()}function c(){if(!this.textEditNode)return;const e=this.mindMap.opt.customInnerElsAppendTo||document.body;e.removeChild(this.textEditNode)}function m(){this.hideEditTextBox()}function u(e){let t=e.node.getBoundingClientRect();this.textEditNode&&(this.textEditNode.style.minWidth=t.width+"px",this.textEditNode.style.minHeight=t.height+"px",this.textEditNode.style.left=t.left+"px",this.textEditNode.style.top=t.top+"px")}function f(){if(!this.showTextEdit)return;let{el:e,textNode:t,node:i,range:s}=this.activeOuterFrame,o=Object(n["N"])(this.textEditNode.innerHTML),a=o===this.mindMap.opt.defaultOuterFrameText;o=a?"":o,this.updateActiveOuterFrame({text:o}),this.textEditNode.style.display="none",this.textEditNode.innerHTML="",this.setIsShowTextEdit(!1),this.renderText(o,e,t,i,s),this.mindMap.emit("hide_text_edit")}function p(e,t,i,n,s){if(!e)return;i.clear();const o=new a["h"];i.add(o);const r=this.getStyle(this.getNodeRangeFirstNode(n,s)),[h,d,l,c]=r.textFillPadding;let m=e.replace(/\n$/g,"").split(/\n/gim);const u=new a["d"];m.forEach((e,t)=>{""===e&&(e="\ufeff");let i=(new a["j"]).text(e);i.y(r.fontSize*r.lineHeight*t),this.styleText(i,r),u.add(i)}),i.add(u);const{width:f,height:p}=i.bbox(),x=f+h+l,g=p+d+c;o.size(x,g).x(0).dy(0),this.styleTextShape(o,r);let z=0;switch(r.textAlign){case"left":z=t.x();break;case"center":z=t.x()+t.width()/2-x/2;break;case"right":z=t.x()+t.width()-x;break;default:break}const y=t.y()-g;o.x(z),o.y(y),u.x(z+h),u.y(y+d)}function x(e,t){e.fill({color:t.textFill}).radius(t.textFillRadius)}function g(e,t){e.fill({color:t.color}).css({"font-family":t.fontFamily,"font-size":t.fontSize+"px","font-weight":t.fontWeight,"font-style":t.fontStyle})}function z(e){const t=e.getData("outerFrame");return t&&t.text?t.text:""}var y={getText:z,createText:h,styleTextShape:x,styleText:g,onScale:m,showEditTextBox:d,setIsShowTextEdit:l,removeTextEditEl:c,hideEditTextBox:f,updateTextEditBoxPos:u,renderText:p};const k={radius:5,strokeWidth:2,strokeColor:"#0984e3",strokeDasharray:"5,5",fill:"rgba(9,132,227,0.05)",fontSize:14,fontFamily:"微软雅黑, Microsoft YaHei",fontWeight:"normal",fontStyle:"normal",color:"#fff",lineHeight:1.2,textFill:"#0984e3",textFillRadius:5,textFillPadding:[5,5,5,5],textAlign:"left"},w="outer-frame-text-edit-warp";class M{constructor(e={}){this.mindMap=e.mindMap,this.draw=null,this.createDrawContainer(),this.isNotRenderOuterFrames=!1,this.textNodeList=[],this.outerFrameElList=[],this.activeOuterFrame=null,this.textEditNode=null,this.showTextEdit=!1,Object.keys(y).forEach(e=>{this[e]=y[e].bind(this)}),this.mindMap.addEditNodeClass(w),this.bindEvent()}createDrawContainer(){this.draw=this.mindMap.draw.group(),this.draw.addClass("smm-outer-frame-container"),this.draw.back(),this.draw.forward()}bindEvent(){this.renderOuterFrames=this.renderOuterFrames.bind(this),this.mindMap.on("node_tree_render_end",this.renderOuterFrames),this.mindMap.on("data_change",this.renderOuterFrames),this.clearActiveOuterFrame=this.clearActiveOuterFrame.bind(this),this.mindMap.on("draw_click",this.clearActiveOuterFrame),this.mindMap.on("node_click",this.clearActiveOuterFrame),this.mindMap.on("scale",this.onScale),this.onBeforeDestroy=this.onBeforeDestroy.bind(this),this.mindMap.on("beforeDestroy",this.onBeforeDestroy),this.addOuterFrame=this.addOuterFrame.bind(this),this.mindMap.command.add("ADD_OUTER_FRAME",this.addOuterFrame),this.removeActiveOuterFrame=this.removeActiveOuterFrame.bind(this),this.mindMap.keyCommand.addShortcut("Del|Backspace",this.removeActiveOuterFrame)}unBindEvent(){this.mindMap.off("node_tree_render_end",this.renderOuterFrames),this.mindMap.off("data_change",this.renderOuterFrames),this.mindMap.off("draw_click",this.clearActiveOuterFrame),this.mindMap.off("node_click",this.clearActiveOuterFrame),this.mindMap.off("scale",this.onScale),this.mindMap.off("beforeDestroy",this.onBeforeDestroy),this.mindMap.command.remove("ADD_OUTER_FRAME",this.addOuterFrame),this.mindMap.keyCommand.removeShortcut("Del|Backspace",this.removeActiveOuterFrame)}onBeforeDestroy(){this.hideEditTextBox(),this.removeTextEditEl()}addOuterFrame(e,t={}){e=Object(n["y"])(e);const i=this.mindMap.renderer.activeNodeList;if(i.length<=0&&e.length<=0)return;let o=e.length>0?e:i;o=o.filter(e=>!e.isRoot&&!e.isGeneralization);const a=s(o);a.forEach(({node:e,range:i})=>{const s=e.children.slice(i[0],i[1]+1),o=Object(n["r"])();s.forEach(e=>{let i=e.getData("outerFrame");i=i?{...i,...t,groupId:o}:{...t,groupId:o},this.mindMap.execCommand("SET_NODE_DATA",e,{outerFrame:i})})})}getActiveOuterFrame(){return this.activeOuterFrame?{...this.activeOuterFrame}:null}removeActiveOuterFrame(){if(!this.activeOuterFrame)return;const{node:e,range:t}=this.activeOuterFrame;this.getRangeNodeList(e,t).forEach(e=>{this.mindMap.execCommand("SET_NODE_DATA",e,{outerFrame:null})}),this.mindMap.emit("outer_frame_delete")}removeActiveOuterFrameText(){this.updateActiveOuterFrame({text:""})}updateActiveOuterFrame(e={}){if(!this.activeOuterFrame)return;this.isNotRenderOuterFrames=!0;const{el:t,node:i,range:n}=this.activeOuterFrame;let s="";this.getRangeNodeList(i,n).forEach(t=>{const i=t.getData("outerFrame"),n={...i,...e};s=n.strokeDasharray,this.mindMap.execCommand("SET_NODE_DATA",t,{outerFrame:n})}),t.cacheStyle={dasharray:s},this.updateOuterFrameStyle()}updateOuterFrameStyle(){const{el:e,node:t,range:i,textNode:n}=this.activeOuterFrame,s=this.getNodeRangeFirstNode(t,i),o=this.getStyle(s);this.styleOuterFrame(e,{...o,strokeDasharray:"none"});const a=this.getText(s);this.renderText(a,e,n,t,i)}getRangeNodeList(e,t){return e.children.slice(t[0],t[1]+1).filter(e=>e.getData("outerFrame"))}getNodeRangeFirstNode(e,t){return e.children[t[0]]}renderOuterFrames(){if(this.isNotRenderOuterFrames)return void(this.isNotRenderOuterFrames=!1);this.clearActiveOuterFrame(),this.clearTextNodes(),this.clearOuterFrameElList();let e=this.mindMap.renderer.root;if(!e)return;const t=this.mindMap.draw.transform(),{outerFramePaddingX:i,outerFramePaddingY:s}=this.mindMap.opt;Object(n["yb"])(e,null,e=>{if(!e)return;const a=o(e);a&&a.length>0&&a.forEach(({nodeList:o,range:a})=>{if(-1===a[0]||-1===a[1])return;const{left:r,top:h,width:d,height:l}=Object(n["I"])(o);if(!Number.isFinite(r)||!Number.isFinite(h)||!Number.isFinite(d)||!Number.isFinite(l))return;const c=this.createOuterFrameEl((r-i-this.mindMap.elRect.left-t.translateX)/t.scaleX,(h-s-this.mindMap.elRect.top-t.translateY)/t.scaleY,(d+2*i)/t.scaleX,(l+2*s)/t.scaleY,this.getStyle(o[0])),m=this.createText(c,e,a);this.textNodeList.push(m),this.renderText(this.getText(o[0]),c,m,e,a),c.on("click",t=>{t.stopPropagation(),this.setActiveOuterFrame(c,e,a,m)})})},()=>{},!0,0)}setActiveOuterFrame(e,t,i,n){this.mindMap.execCommand("CLEAR_ACTIVE_NODE"),this.clearActiveOuterFrame(),this.activeOuterFrame={el:e,node:t,range:i,textNode:n},e.stroke({dasharray:"none"}),this.getText(this.getNodeRangeFirstNode(t,i))||this.renderText(this.mindMap.opt.defaultOuterFrameText,e,n,t,i),this.mindMap.emit("outer_frame_active",e,t,i)}clearActiveOuterFrame(){if(!this.activeOuterFrame)return;const{el:e,textNode:t,node:i,range:n}=this.activeOuterFrame;e.stroke({dasharray:e.cacheStyle.dasharray||k.strokeDasharray}),this.hideEditTextBox(),this.getText(this.getNodeRangeFirstNode(i,n))||t.clear(),this.activeOuterFrame=null,this.mindMap.emit("outer_frame_deactivate")}getStyle(e){return{...k,...e.getData("outerFrame")||{}}}createOuterFrameEl(e,t,i,n,s={}){const o=this.draw.rect().size(i,n).x(e).y(t);return this.styleOuterFrame(o,s),o.cacheStyle={dasharray:s.strokeDasharray},this.outerFrameElList.push(o),o}styleOuterFrame(e,t){e.radius(t.radius).stroke({width:t.strokeWidth,color:t.strokeColor,dasharray:t.strokeDasharray}).fill({color:t.fill})}clearTextNodes(){this.textNodeList.forEach(e=>{e.remove()})}clearOuterFrameElList(){this.outerFrameElList.forEach(e=>{e.remove()}),this.outerFrameElList=[],this.activeOuterFrame=null}beforePluginRemove(){this.mindMap.deleteEditNodeClass(w),this.unBindEvent()}beforePluginDestroy(){this.mindMap.deleteEditNodeClass(w),this.unBindEvent()}}M.instanceName="outerFrame",M.defaultStyle=k;t["a"]=M}}]);